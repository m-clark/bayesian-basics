<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Appendix | Bayesian Basics</title>
  <meta name="description" content="This document provides an introduction to Bayesian data analysis. It is conceptual in nature, but uses the probabilistic programming language Stan for demonstration (and its implementation in R via rstan). From elementary examples, guidance is provided for data preparation, efficient modeling, diagnostics, and more." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Appendix | Bayesian Basics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/bayesian-basics/" />
  <meta property="og:image" content="https://m-clark.github.io/bayesian-basics//img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides an introduction to Bayesian data analysis. It is conceptual in nature, but uses the probabilistic programming language Stan for demonstration (and its implementation in R via rstan). From elementary examples, guidance is provided for data preparation, efficient modeling, diagnostics, and more." />
  <meta name="github-repo" content="m-clark/bayesian-basics/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Appendix | Bayesian Basics" />
  
  <meta name="twitter:description" content="This document provides an introduction to Bayesian data analysis. It is conceptual in nature, but uses the probabilistic programming language Stan for demonstration (and its implementation in R via rstan). From elementary examples, guidance is provided for data preparation, efficient modeling, diagnostics, and more." />
  <meta name="twitter:image" content="https://m-clark.github.io/bayesian-basics//img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="conclusion.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/r_and_stan.png" style="width:75%; padding:10px 10px;"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#going-further"><i class="fa fa-check"></i>Going Further</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#note"><i class="fa fa-check"></i>Note</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#bayesian-probability"><i class="fa fa-check"></i>Bayesian Probability</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#conditional-probability-bayes-theorem"><i class="fa fa-check"></i>Conditional probability &amp; Bayes theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i>A Hands-on Example</a>
<ul>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="example.html"><a href="example.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i>Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="models.html"><a href="models.html#example-linear-regression-model"><i class="fa fa-check"></i>Example: Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="models.html"><a href="models.html#setup"><i class="fa fa-check"></i>Setup</a></li>
<li class="chapter" data-level="" data-path="models.html"><a href="models.html#stan-code"><i class="fa fa-check"></i>Stan Code</a></li>
<li class="chapter" data-level="" data-path="models.html"><a href="models.html#running-the-model"><i class="fa fa-check"></i>Running the Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i>Model Exploration</a>
<ul>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#monitoring-convergence"><i class="fa fa-check"></i>Monitoring Convergence</a>
<ul>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#visual-inspection-traceplot-densities"><i class="fa fa-check"></i>Visual Inspection: Traceplot &amp; Densities</a></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#statistical-measures"><i class="fa fa-check"></i>Statistical Measures</a></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#autocorrelation"><i class="fa fa-check"></i>Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#model-criticism"><i class="fa fa-check"></i>Model Criticism</a>
<ul>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#sensitivity-analysis"><i class="fa fa-check"></i>Sensitivity Analysis</a></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#predictive-accuracy-model-comparison"><i class="fa fa-check"></i>Predictive Accuracy &amp; Model Comparison</a></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#posterior-predictive-checking-statistical"><i class="fa fa-check"></i>Posterior Predictive Checking: Statistical</a></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#posterior-predictive-checking-graphical"><i class="fa fa-check"></i>Posterior Predictive Checking: Graphical</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="diagnostics.html"><a href="diagnostics.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="enhancements.html"><a href="enhancements.html"><i class="fa fa-check"></i>Model Enhancements</a>
<ul>
<li class="chapter" data-level="" data-path="enhancements.html"><a href="enhancements.html#generating-new-variables-of-interest"><i class="fa fa-check"></i>Generating New Variables of Interest</a></li>
<li class="chapter" data-level="" data-path="enhancements.html"><a href="enhancements.html#robust-regression"><i class="fa fa-check"></i>Robust Regression</a></li>
<li class="chapter" data-level="" data-path="enhancements.html"><a href="enhancements.html#generalized-linear-model"><i class="fa fa-check"></i>Generalized Linear Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#debugging"><i class="fa fa-check"></i>Debugging</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#choice-of-prior"><i class="fa fa-check"></i>Choice of Prior</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#noninformative-weakly-informative-informative"><i class="fa fa-check"></i>Noninformative, Weakly Informative, Informative</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#conjugacy"><i class="fa fa-check"></i>Conjugacy</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#test-your-priors-beforehand"><i class="fa fa-check"></i>Test your Priors Beforehand</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#hierarchical-priors"><i class="fa fa-check"></i>Hierarchical Priors</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#sensitivity-analysis-revisited"><i class="fa fa-check"></i>Sensitivity Analysis Revisited</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#a-simple-check"><i class="fa fa-check"></i>A Simple Check</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#sampling-procedure"><i class="fa fa-check"></i>Sampling Procedure</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#metropolis"><i class="fa fa-check"></i>Metropolis</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#gibbs"><i class="fa fa-check"></i>Gibbs</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#other-variations-and-approximate-methods"><i class="fa fa-check"></i>Other Variations and Approximate Methods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#number-of-draws-thinning-warm-up"><i class="fa fa-check"></i>Number of draws, thinning, warm-up</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#model-complexity"><i class="fa fa-check"></i>Model Complexity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>R Packages</a>
<ul>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#standard-regression-and-glm"><i class="fa fa-check"></i>Standard Regression and GLM</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#categorical-models"><i class="fa fa-check"></i>Categorical Models</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#extended-count-models"><i class="fa fa-check"></i>Extended Count Models</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#mixed-models"><i class="fa fa-check"></i>Mixed Models</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#other-models-and-related"><i class="fa fa-check"></i>Other Models and Related</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#even-more-packages"><i class="fa fa-check"></i>Even More Packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Final Thoughts</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#maximum-likelihood-review"><i class="fa fa-check"></i>Maximum Likelihood Review</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#binomial-likelihood-example"><i class="fa fa-check"></i>Binomial Likelihood Example</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#modeling-languages"><i class="fa fa-check"></i>Modeling Languages</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#bugs"><i class="fa fa-check"></i>Bugs</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#jags"><i class="fa fa-check"></i>JAGS</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#nimble"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#stan"><i class="fa fa-check"></i>Stan</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#general-statistical-packages"><i class="fa fa-check"></i>General Statistical Packages</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#other-programming-languages"><i class="fa fa-check"></i>Other Programming Languages</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#bugs-example"><i class="fa fa-check"></i>BUGS Example</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#jags-example"><i class="fa fa-check"></i>JAGS Example</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#metropolis-hastings-example"><i class="fa fa-check"></i>Metropolis Hastings Example</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#hamiltonian-monte-carlo-example"><i class="fa fa-check"></i>Hamiltonian Monte Carlo Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#texts-for-your-shelf"><i class="fa fa-check"></i>Texts for Your Shelf</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#stan-specific-resources"><i class="fa fa-check"></i>Stan Specific Resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#works-citedused"><i class="fa fa-check"></i>Works Cited/Used</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Basics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="maximum-likelihood-review" class="section level2">
<h2>Maximum Likelihood Review</h2>
<p>This is a very brief refresher on <em>maximum likelihood estimation</em> using a standard regression approach as an example. Given the likelihood’s role in Bayesian estimation and statistics in general, and the ties between specific Bayesian results and maximum likelihood estimates one typically comes across, one should be conceptually comfortable with some basic likelihood estimation.</p>
<p>In the standard model setting we attempt to find parameters <span class="math inline">\(\theta\)</span> that will maximize the probability of the data we actually observe. We’ll start with an observed random target vector <span class="math inline">\(y\)</span> with <span class="math inline">\(i...N\)</span> independent and identically distributed observations and some data-generating process underlying it <span class="math inline">\(f(\cdot|\theta)\)</span>. The key idea is that we are interested in estimating the model parameter(s), <span class="math inline">\(\theta\)</span>, that would make the data most likely to have occurred. The probability density function for an observed value of <span class="math inline">\(y\)</span> given some particular estimate for the parameters can be noted as <span class="math inline">\(f(y_i|\theta)\)</span>. The joint probability distribution of the (independent) observations given those parameters is the product of the individual densities, and this is our basic <em>likelihood function</em>. We can write it out generally as:</p>
<p><span class="math display">\[\mathcal{L}(\theta) = \prod_{i=1}^N f(y_i|\theta)\]</span></p>
<!-- <img src="img/maxLikeNormalCompareLLforDifferentMeans.svg" style="display:block; margin: 0 auto; width:50%"> -->
<p>So the <em>likelihood</em> for one set of parameter estimates given a fixed set of data y, is equal to the probability of the data given those (fixed) estimates. Furthermore, we can compare one set, <span class="math inline">\(\mathcal{L}(\theta_A)\)</span>, to that of another, <span class="math inline">\(\mathcal{L}(\theta_B)\)</span>, and whichever produces the greater likelihood would be the preferred set of estimates. We can get a sense of this with the following visualization, based on a single parameter, Poisson distributed variable. The data is drawn from a variable with mean <span class="math inline">\(\theta=5\)</span>. We note the calculated likelihood increases as we estimate values for <span class="math inline">\(\theta\)</span> closer to <span class="math inline">\(5\)</span>. With more and more data, the final ML estimate will converge on the true value.</p>
<pre><code>Final estimate = 5.02</code></pre>
<p><img src="Bayesian-Basics_files/figure-html/maxLikeillustration-1.svg" width="500px" style="display: block; margin: auto;" /></p>
<p>For computational reasons, we instead work with the sum of the natural log probabilities<a href="#fn56" class="footnote-ref" id="fnref56"><sup>56</sup></a>, and thus the <em>log likelihood</em>:</p>
<p><span class="math display">\[\ln\mathcal{L}(\theta) = \sum_{i=1}^N \ln[f(y_i|\theta)]\]</span></p>
<p>Concretely, we calculate a log likelihood for each observation and then sum them for the total likelihood for parameter(s) <span class="math inline">\(\theta\)</span>.</p>
<p>The likelihood function incorporates our assumption about the sampling distribution of the data given some estimate for the parameters. It can take on many forms and be notably complex depending on the model in question, but once specified, we can use any number of optimization approaches to find the estimates of the parameter that make the data most likely. As an example, for a normally distributed variable of interest we can write the log likelihood as follows:</p>
<p><span class="math display">\[\ln\mathcal{L}(\theta) = \sum_{i=1}^N \ln[\frac{1}{\sqrt{2\pi\sigma^2}}\exp(-\frac{(y-\mu)^2}{2\sigma^2})]\]</span></p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>In the following we will demonstrate the maximum likelihood approach to estimation for a simple setting incorporating a normal distribution, where we estimate the mean and variance/sd for a set of values <span class="math inline">\(y\)</span><a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a>. First the data is created, and then we create the function that will compute the log likelihood. Using the built in R distributions<a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a> makes it fairly straightforward to create our own likelihood function and feed it into an optimization function to find the best parameters. We will set things up to work with the <span class="pack">bbmle</span> package, which has some nice summary functionality and other features. However, one should take a glance at <span class="func">optim</span> and the other underlying functions that do the work.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="appendix.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for replication</span></span>
<span id="cb49-2"><a href="appendix.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-3"><a href="appendix.html#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="appendix.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create the data</span></span>
<span id="cb49-5"><a href="appendix.html#cb49-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb49-6"><a href="appendix.html#cb49-6" aria-hidden="true" tabindex="-1"></a>startvals <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb49-7"><a href="appendix.html#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="appendix.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the log likelihood function</span></span>
<span id="cb49-9"><a href="appendix.html#cb49-9" aria-hidden="true" tabindex="-1"></a>LL <span class="ot">=</span> <span class="cf">function</span>(<span class="at">mu =</span> startvals[<span class="dv">1</span>], <span class="at">sigma =</span> startvals[<span class="dv">2</span>], <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb49-10"><a href="appendix.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-11"><a href="appendix.html#cb49-11" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">=</span> <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb49-12"><a href="appendix.html#cb49-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-13"><a href="appendix.html#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose) <span class="fu">message</span>(<span class="fu">paste</span>(mu, sigma, ll))</span>
<span id="cb49-14"><a href="appendix.html#cb49-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-15"><a href="appendix.html#cb49-15" aria-hidden="true" tabindex="-1"></a>  ll</span>
<span id="cb49-16"><a href="appendix.html#cb49-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <span class="func">LL</span> function takes starting points for the parameters as arguments, in this case we call them <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, which will be set to 0 and 1 respectively. Only the first line (ll = -sum…) is actually necessary, and we use <span class="func">dnorm</span> to get the density for each point<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a>. Since this optimizer is by default minimization, we reverse the sign of the sum so as to <em>minimize the negative log likelihood</em>, which is the same as maximizing the likelihood. Note that the bit of other code just allows you to see the estimates as the optimization procedure searches for the best values. I do not show that here, but you’ll see it in your console if <code>verbose=TRUE</code>.</p>
<p>We are now ready to obtain maximum likelihood estimates for the parameters. For the <span class="func">mle2</span> function we will need the function we’ve created, plus other inputs related to that function or the underlying optimizing function used (by default <span class="func">optim</span>). In this case we will use an optimization procedure that will allow us to set a lower bound for <span class="math inline">\(\sigma\)</span>. This isn’t strictly necessary, but otherwise you would get warnings and possibly lack of convergence if negative estimates for <span class="math inline">\(\sigma\)</span> were allowed<a href="#fn60" class="footnote-ref" id="fnref60"><sup>60</sup></a>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="appendix.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb50-2"><a href="appendix.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using optim, and L-BFGS-B so as to constrain sigma to be positive by setting</span></span>
<span id="cb50-3"><a href="appendix.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the lower bound at zero</span></span>
<span id="cb50-4"><a href="appendix.html#cb50-4" aria-hidden="true" tabindex="-1"></a>mlnorm <span class="ot">=</span>  <span class="fu">mle2</span>(</span>
<span id="cb50-5"><a href="appendix.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  LL,</span>
<span id="cb50-6"><a href="appendix.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">start  =</span> <span class="fu">list</span>(<span class="at">mu =</span> <span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">1</span>),</span>
<span id="cb50-7"><a href="appendix.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb50-8"><a href="appendix.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower  =</span> <span class="fu">c</span>(<span class="at">sigma =</span> <span class="dv">0</span>)</span>
<span id="cb50-9"><a href="appendix.html#cb50-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-10"><a href="appendix.html#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="appendix.html#cb50-11" aria-hidden="true" tabindex="-1"></a>mlnorm</span></code></pre></div>
<pre><code>
Call:
mle2(minuslogl = LL, start = list(mu = 2, sigma = 1), method = &quot;L-BFGS-B&quot;, 
    lower = c(sigma = 0))

Coefficients:
      mu    sigma 
4.946803 1.993680 

Log-likelihood: -2108.92 </code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="appendix.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to an intercept only regression model</span></span>
<span id="cb52-2"><a href="appendix.html#cb52-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code># A tibble: 1 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)     4.95    0.0631      78.4       0</code></pre>
<p>We can see that the ML estimates are the same as the intercept only model estimates<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a>, which given the sample size are close to the true values.</p>
<p>In terms of the parameters we estimate, in the typical case of two or more parameters we can think of a <em>likelihood surface</em> that represents the possible likelihood values given any particular set of estimates. Given some starting point, the optimization procedure then travels along the surface looking for a minimum/maximum point<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a>. For simpler settings such as this, we can visualize the likelihood surface and its minimum point. The optimizer travels along this surface until it finds a minimum (the surface plot is interactive- feel free to adjust). I also plot the path of the optimizer from a top down view. The large blue dot noted represents the minimum negative log likelihood.</p>
<div id="htmlwidget-1d319e990fb3bc05c25c" style="width:750px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1d319e990fb3bc05c25c">{"x":{"visdat":{"f9d172892753":["function () ","plotlyVisDat"],"f9d1a74f4e4":["function () ","data"]},"cur_data":"f9d1a74f4e4","attrs":{"f9d172892753":{"x":{},"y":{},"z":{},"showscale":false,"colors":["#0D0887FF","#0F0787FF","#100788FF","#120789FF","#130789FF","#150789FF","#16078AFF","#18068BFF","#19068CFF","#1A068DFF","#1B068DFF","#1C068EFF","#1D068EFF","#1F068FFF","#20068FFF","#210690FF","#220690FF","#230691FF","#240691FF","#250591FF","#260591FF","#270592FF","#280592FF","#2A0593FF","#2B0593FF","#2C0594FF","#2D0594FF","#2E0595FF","#2E0595FF","#2F0596FF","#300596FF","#310597FF","#320597FF","#330597FF","#340597FF","#350498FF","#360498FF","#370499FF","#370499FF","#38049AFF","#39049AFF","#3A049AFF","#3B049AFF","#3C049BFF","#3D049CFF","#3E049CFF","#3F049CFF","#3F049CFF","#40049CFF","#41049DFF","#42039EFF","#43039EFF","#44039EFF","#44039EFF","#45039FFF","#46039FFF","#47039FFF","#48039FFF","#4903A0FF","#4903A0FF","#4A03A1FF","#4B03A1FF","#4C02A1FF","#4C02A1FF","#4D02A2FF","#4F02A2FF","#5002A2FF","#5002A2FF","#5102A3FF","#5102A3FF","#5202A3FF","#5402A3FF","#5502A4FF","#5502A4FF","#5601A4FF","#5701A4FF","#5801A4FF","#5801A4FF","#5901A5FF","#5A01A5FF","#5B01A5FF","#5B01A5FF","#5C01A6FF","#5D01A6FF","#5E01A6FF","#5F01A6FF","#6001A6FF","#6001A6FF","#6100A7FF","#6200A7FF","#6300A7FF","#6300A7FF","#6400A7FF","#6500A7FF","#6600A7FF","#6700A8FF","#6700A8FF","#6800A8FF","#6900A8FF","#6A00A8FF","#6A00A8FF","#6B00A8FF","#6C00A8FF","#6D00A8FF","#6E00A8FF","#6F00A8FF","#6F00A8FF","#7000A8FF","#7100A8FF","#7201A8FF","#7201A8FF","#7301A8FF","#7401A8FF","#7501A8FF","#7501A8FF","#7701A8FF","#7701A8FF","#7801A8FF","#7901A8FF","#7A02A8FF","#7A02A8FF","#7B02A8FF","#7C02A8FF","#7D03A8FF","#7D03A8FF","#7E03A8FF","#7F03A8FF","#8004A8FF","#8004A8FF","#8104A7FF","#8204A7FF","#8305A7FF","#8305A7FF","#8405A7FF","#8505A7FF","#8606A6FF","#8707A6FF","#8707A6FF","#8708A6FF","#8808A6FF","#8909A5FF","#8A09A5FF","#8B0AA5FF","#8B0AA5FF","#8C0BA5FF","#8D0BA5FF","#8E0CA4FF","#8E0CA4FF","#8E0DA4FF","#8F0DA4FF","#900EA3FF","#910EA3FF","#920FA3FF","#920FA3FF","#9310A2FF","#9410A2FF","#9511A1FF","#9511A1FF","#9613A1FF","#9613A1FF","#9814A0FF","#9814A0FF","#99159FFF","#99159FFF","#9A169FFF","#9B169FFF","#9C179EFF","#9C179EFF","#9D189DFF","#9D189DFF","#9E199DFF","#9F199DFF","#A01A9CFF","#A11A9CFF","#A11B9BFF","#A11C9AFF","#A21D9AFF","#A21E9AFF","#A31E9AFF","#A41E9AFF","#A51F99FF","#A62098FF","#A62098FF","#A72197FF","#A72197FF","#A72296FF","#A82296FF","#A92395FF","#AA2395FF","#AB2394FF","#AB2494FF","#AC2594FF","#AC2694FF","#AD2793FF","#AD2793FF","#AE2892FF","#AE2892FF","#AF2991FF","#B02991FF","#B12A90FF","#B12A90FF","#B22B8FFF","#B22B8FFF","#B32C8EFF","#B32C8EFF","#B42E8DFF","#B42E8DFF","#B52F8CFF","#B52F8CFF","#B6308BFF","#B6308BFF","#B7318AFF","#B7318AFF","#B83289FF","#B93289FF","#BA3388FF","#BA3388FF","#BB3488FF","#BB3488FF","#BC3587FF","#BC3687FF","#BD3786FF","#BD3886FF","#BE3885FF","#BE3885FF","#BF3984FF","#BF3984FF","#C03A83FF","#C13B82FF","#C13B82FF","#C23C81FF","#C23C81FF","#C33D80FF","#C33D80FF","#C43D7FFF","#C43E7FFF","#C53F7EFF","#C5407EFF","#C6417DFF","#C6417DFF","#C7427CFF","#C7427CFF","#C8437BFF","#C8437BFF","#C9447AFF","#C9447AFF","#CA457AFF","#CA457AFF","#CB4679FF","#CB4679FF","#CC4778FF","#CC4878FF","#CC4977FF","#CC4977FF","#CD4A76FF","#CD4A76FF","#CE4B75FF","#CE4B75FF","#CF4C74FF","#CF4C74FF","#D04D73FF","#D04D73FF","#D14E72FF","#D14E72FF","#D24F71FF","#D25071FF","#D35171FF","#D35271FF","#D45270FF","#D55270FF","#D5536FFF","#D5536FFF","#D5546EFF","#D5556DFF","#D6556DFF","#D7566CFF","#D7566CFF","#D8576BFF","#D8576BFF","#D9576AFF","#D9586AFF","#DA596AFF","#DA5A6AFF","#DA5B69FF","#DA5B69FF","#DB5C68FF","#DB5C68FF","#DC5D67FF","#DC5D67FF","#DD5E66FF","#DD5E66FF","#DE5F65FF","#DE5F65FF","#DE6064FF","#DE6164FF","#DF6263FF","#DF6263FF","#E06363FF","#E06363FF","#E16462FF","#E16462FF","#E26561FF","#E26561FF","#E26660FF","#E26760FF","#E3685FFF","#E3685FFF","#E4695EFF","#E4695EFF","#E56A5DFF","#E56A5DFF","#E56B5DFF","#E56B5DFF","#E66C5CFF","#E76D5CFF","#E76E5BFF","#E76F5BFF","#E76F5AFF","#E76F59FF","#E87059FF","#E97159FF","#E97158FF","#E97157FF","#E97257FF","#E97357FF","#EA7457FF","#EB7556FF","#EB7556FF","#EB7655FF","#EB7655FF","#EC7754FF","#EC7754FF","#ED7853FF","#ED7953FF","#ED7A52FF","#ED7A52FF","#EE7B51FF","#EE7B51FF","#EF7C51FF","#EF7C51FF","#EF7E50FF","#EF7E50FF","#F07F4FFF","#F07F4FFF","#F0804EFF","#F0804EFF","#F1814DFF","#F1824DFF","#F1834CFF","#F1834CFF","#F2844BFF","#F2844BFF","#F3854BFF","#F3864BFF","#F3874AFF","#F3884AFF","#F48849FF","#F48849FF","#F48948FF","#F48A48FF","#F58B47FF","#F58C47FF","#F58C46FF","#F58C46FF","#F68D45FF","#F68E44FF","#F68F44FF","#F79044FF","#F79044FF","#F79044FF","#F79143FF","#F79242FF","#F79342FF","#F89441FF","#F89441FF","#F89440FF","#F89540FF","#F9963FFF","#F9973FFF","#F9983EFF","#F9983EFF","#F9993EFF","#F99A3EFF","#FA9B3DFF","#FA9B3DFF","#FA9C3CFF","#FA9C3CFF","#FA9E3BFF","#FA9E3BFF","#FB9F3AFF","#FBA03AFF","#FBA139FF","#FBA139FF","#FBA238FF","#FBA238FF","#FCA338FF","#FCA438FF","#FCA537FF","#FCA537FF","#FCA636FF","#FCA736FF","#FCA835FF","#FCA835FF","#FCA934FF","#FCAA33FF","#FDAB33FF","#FDAB33FF","#FDAC33FF","#FDAD33FF","#FDAE32FF","#FDAF31FF","#FDAF31FF","#FDB030FF","#FDB130FF","#FDB22FFF","#FDB22FFF","#FDB32FFF","#FDB42FFF","#FDB52EFF","#FDB52EFF","#FEB62DFF","#FEB72DFF","#FEB82CFF","#FEB82CFF","#FEB92CFF","#FEBA2CFF","#FEBB2BFF","#FEBB2BFF","#FEBC2AFF","#FEBD2AFF","#FEBE2AFF","#FEBE2AFF","#FEBF29FF","#FEC129FF","#FDC229FF","#FDC229FF","#FDC328FF","#FDC428FF","#FDC527FF","#FDC527FF","#FDC627FF","#FDC727FF","#FDC827FF","#FDC927FF","#FDCA26FF","#FDCA26FF","#FDCB26FF","#FDCC26FF","#FCCD25FF","#FCCD25FF","#FCCE25FF","#FCCF25FF","#FCD025FF","#FCD125FF","#FCD225FF","#FBD324FF","#FBD324FF","#FBD424FF","#FBD524FF","#FBD624FF","#FBD724FF","#FAD824FF","#FAD824FF","#FAD924FF","#FADA24FF","#F9DB24FF","#F9DC24FF","#F9DD25FF","#F9DD25FF","#F8DE25FF","#F8DF25FF","#F8E125FF","#F8E125FF","#F7E225FF","#F7E225FF","#F7E325FF","#F7E525FF","#F6E626FF","#F6E726FF","#F6E826FF","#F6E826FF","#F5E926FF","#F5EA26FF","#F5EB27FF","#F5EC27FF","#F4ED27FF","#F4ED27FF","#F3EE27FF","#F3EF27FF","#F3F027FF","#F3F127FF","#F2F227FF","#F1F327FF","#F1F426FF","#F1F426FF","#F1F525FF","#F1F625FF","#F0F724FF","#F0F823FF","#F0F921FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true},"f9d1a74f4e4":{"x":{},"y":{},"z":{},"showscale":false,"colors":["#0D0887FF","#0F0787FF","#100788FF","#120789FF","#130789FF","#150789FF","#16078AFF","#18068BFF","#19068CFF","#1A068DFF","#1B068DFF","#1C068EFF","#1D068EFF","#1F068FFF","#20068FFF","#210690FF","#220690FF","#230691FF","#240691FF","#250591FF","#260591FF","#270592FF","#280592FF","#2A0593FF","#2B0593FF","#2C0594FF","#2D0594FF","#2E0595FF","#2E0595FF","#2F0596FF","#300596FF","#310597FF","#320597FF","#330597FF","#340597FF","#350498FF","#360498FF","#370499FF","#370499FF","#38049AFF","#39049AFF","#3A049AFF","#3B049AFF","#3C049BFF","#3D049CFF","#3E049CFF","#3F049CFF","#3F049CFF","#40049CFF","#41049DFF","#42039EFF","#43039EFF","#44039EFF","#44039EFF","#45039FFF","#46039FFF","#47039FFF","#48039FFF","#4903A0FF","#4903A0FF","#4A03A1FF","#4B03A1FF","#4C02A1FF","#4C02A1FF","#4D02A2FF","#4F02A2FF","#5002A2FF","#5002A2FF","#5102A3FF","#5102A3FF","#5202A3FF","#5402A3FF","#5502A4FF","#5502A4FF","#5601A4FF","#5701A4FF","#5801A4FF","#5801A4FF","#5901A5FF","#5A01A5FF","#5B01A5FF","#5B01A5FF","#5C01A6FF","#5D01A6FF","#5E01A6FF","#5F01A6FF","#6001A6FF","#6001A6FF","#6100A7FF","#6200A7FF","#6300A7FF","#6300A7FF","#6400A7FF","#6500A7FF","#6600A7FF","#6700A8FF","#6700A8FF","#6800A8FF","#6900A8FF","#6A00A8FF","#6A00A8FF","#6B00A8FF","#6C00A8FF","#6D00A8FF","#6E00A8FF","#6F00A8FF","#6F00A8FF","#7000A8FF","#7100A8FF","#7201A8FF","#7201A8FF","#7301A8FF","#7401A8FF","#7501A8FF","#7501A8FF","#7701A8FF","#7701A8FF","#7801A8FF","#7901A8FF","#7A02A8FF","#7A02A8FF","#7B02A8FF","#7C02A8FF","#7D03A8FF","#7D03A8FF","#7E03A8FF","#7F03A8FF","#8004A8FF","#8004A8FF","#8104A7FF","#8204A7FF","#8305A7FF","#8305A7FF","#8405A7FF","#8505A7FF","#8606A6FF","#8707A6FF","#8707A6FF","#8708A6FF","#8808A6FF","#8909A5FF","#8A09A5FF","#8B0AA5FF","#8B0AA5FF","#8C0BA5FF","#8D0BA5FF","#8E0CA4FF","#8E0CA4FF","#8E0DA4FF","#8F0DA4FF","#900EA3FF","#910EA3FF","#920FA3FF","#920FA3FF","#9310A2FF","#9410A2FF","#9511A1FF","#9511A1FF","#9613A1FF","#9613A1FF","#9814A0FF","#9814A0FF","#99159FFF","#99159FFF","#9A169FFF","#9B169FFF","#9C179EFF","#9C179EFF","#9D189DFF","#9D189DFF","#9E199DFF","#9F199DFF","#A01A9CFF","#A11A9CFF","#A11B9BFF","#A11C9AFF","#A21D9AFF","#A21E9AFF","#A31E9AFF","#A41E9AFF","#A51F99FF","#A62098FF","#A62098FF","#A72197FF","#A72197FF","#A72296FF","#A82296FF","#A92395FF","#AA2395FF","#AB2394FF","#AB2494FF","#AC2594FF","#AC2694FF","#AD2793FF","#AD2793FF","#AE2892FF","#AE2892FF","#AF2991FF","#B02991FF","#B12A90FF","#B12A90FF","#B22B8FFF","#B22B8FFF","#B32C8EFF","#B32C8EFF","#B42E8DFF","#B42E8DFF","#B52F8CFF","#B52F8CFF","#B6308BFF","#B6308BFF","#B7318AFF","#B7318AFF","#B83289FF","#B93289FF","#BA3388FF","#BA3388FF","#BB3488FF","#BB3488FF","#BC3587FF","#BC3687FF","#BD3786FF","#BD3886FF","#BE3885FF","#BE3885FF","#BF3984FF","#BF3984FF","#C03A83FF","#C13B82FF","#C13B82FF","#C23C81FF","#C23C81FF","#C33D80FF","#C33D80FF","#C43D7FFF","#C43E7FFF","#C53F7EFF","#C5407EFF","#C6417DFF","#C6417DFF","#C7427CFF","#C7427CFF","#C8437BFF","#C8437BFF","#C9447AFF","#C9447AFF","#CA457AFF","#CA457AFF","#CB4679FF","#CB4679FF","#CC4778FF","#CC4878FF","#CC4977FF","#CC4977FF","#CD4A76FF","#CD4A76FF","#CE4B75FF","#CE4B75FF","#CF4C74FF","#CF4C74FF","#D04D73FF","#D04D73FF","#D14E72FF","#D14E72FF","#D24F71FF","#D25071FF","#D35171FF","#D35271FF","#D45270FF","#D55270FF","#D5536FFF","#D5536FFF","#D5546EFF","#D5556DFF","#D6556DFF","#D7566CFF","#D7566CFF","#D8576BFF","#D8576BFF","#D9576AFF","#D9586AFF","#DA596AFF","#DA5A6AFF","#DA5B69FF","#DA5B69FF","#DB5C68FF","#DB5C68FF","#DC5D67FF","#DC5D67FF","#DD5E66FF","#DD5E66FF","#DE5F65FF","#DE5F65FF","#DE6064FF","#DE6164FF","#DF6263FF","#DF6263FF","#E06363FF","#E06363FF","#E16462FF","#E16462FF","#E26561FF","#E26561FF","#E26660FF","#E26760FF","#E3685FFF","#E3685FFF","#E4695EFF","#E4695EFF","#E56A5DFF","#E56A5DFF","#E56B5DFF","#E56B5DFF","#E66C5CFF","#E76D5CFF","#E76E5BFF","#E76F5BFF","#E76F5AFF","#E76F59FF","#E87059FF","#E97159FF","#E97158FF","#E97157FF","#E97257FF","#E97357FF","#EA7457FF","#EB7556FF","#EB7556FF","#EB7655FF","#EB7655FF","#EC7754FF","#EC7754FF","#ED7853FF","#ED7953FF","#ED7A52FF","#ED7A52FF","#EE7B51FF","#EE7B51FF","#EF7C51FF","#EF7C51FF","#EF7E50FF","#EF7E50FF","#F07F4FFF","#F07F4FFF","#F0804EFF","#F0804EFF","#F1814DFF","#F1824DFF","#F1834CFF","#F1834CFF","#F2844BFF","#F2844BFF","#F3854BFF","#F3864BFF","#F3874AFF","#F3884AFF","#F48849FF","#F48849FF","#F48948FF","#F48A48FF","#F58B47FF","#F58C47FF","#F58C46FF","#F58C46FF","#F68D45FF","#F68E44FF","#F68F44FF","#F79044FF","#F79044FF","#F79044FF","#F79143FF","#F79242FF","#F79342FF","#F89441FF","#F89441FF","#F89440FF","#F89540FF","#F9963FFF","#F9973FFF","#F9983EFF","#F9983EFF","#F9993EFF","#F99A3EFF","#FA9B3DFF","#FA9B3DFF","#FA9C3CFF","#FA9C3CFF","#FA9E3BFF","#FA9E3BFF","#FB9F3AFF","#FBA03AFF","#FBA139FF","#FBA139FF","#FBA238FF","#FBA238FF","#FCA338FF","#FCA438FF","#FCA537FF","#FCA537FF","#FCA636FF","#FCA736FF","#FCA835FF","#FCA835FF","#FCA934FF","#FCAA33FF","#FDAB33FF","#FDAB33FF","#FDAC33FF","#FDAD33FF","#FDAE32FF","#FDAF31FF","#FDAF31FF","#FDB030FF","#FDB130FF","#FDB22FFF","#FDB22FFF","#FDB32FFF","#FDB42FFF","#FDB52EFF","#FDB52EFF","#FEB62DFF","#FEB72DFF","#FEB82CFF","#FEB82CFF","#FEB92CFF","#FEBA2CFF","#FEBB2BFF","#FEBB2BFF","#FEBC2AFF","#FEBD2AFF","#FEBE2AFF","#FEBE2AFF","#FEBF29FF","#FEC129FF","#FDC229FF","#FDC229FF","#FDC328FF","#FDC428FF","#FDC527FF","#FDC527FF","#FDC627FF","#FDC727FF","#FDC827FF","#FDC927FF","#FDCA26FF","#FDCA26FF","#FDCB26FF","#FDCC26FF","#FCCD25FF","#FCCD25FF","#FCCE25FF","#FCCF25FF","#FCD025FF","#FCD125FF","#FCD225FF","#FBD324FF","#FBD324FF","#FBD424FF","#FBD524FF","#FBD624FF","#FBD724FF","#FAD824FF","#FAD824FF","#FAD924FF","#FADA24FF","#F9DB24FF","#F9DC24FF","#F9DD25FF","#F9DD25FF","#F8DE25FF","#F8DF25FF","#F8E125FF","#F8E125FF","#F7E225FF","#F7E225FF","#F7E325FF","#F7E525FF","#F6E626FF","#F6E726FF","#F6E826FF","#F6E826FF","#F5E926FF","#F5EA26FF","#F5EB27FF","#F5EC27FF","#F4ED27FF","#F4ED27FF","#F3EE27FF","#F3EF27FF","#F3F027FF","#F3F127FF","#F2F227FF","#F1F327FF","#F1F426FF","#F1F426FF","#F1F525FF","#F1F625FF","#F0F724FF","#F0F823FF","#F0F921FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"mode":"markers","marker":{"color":{"orange":"#ff5500","complementary":["#ff5500","#00aaff"],"monochromatic":["#ff5500","#f26924","#e67a45","#d98a62"],"analogous":["#ff5500","#ffd500","#ff002b"],"split_complementary":["#ff5500","#002bff","#00ffd5"],"triadic":["#ff5500","#5500ff","#00ff55"],"tetradic":["#ff5500","#00aaff","#5500ff","#aaff00"]},"size":3},"type":"scatter3d","showlegend":false,"inherit":true},"f9d1a74f4e4.1":{"x":4.94680327041371,"y":1.99367954739935,"z":2108.91964008206,"showscale":false,"colors":["#0D0887FF","#0F0787FF","#100788FF","#120789FF","#130789FF","#150789FF","#16078AFF","#18068BFF","#19068CFF","#1A068DFF","#1B068DFF","#1C068EFF","#1D068EFF","#1F068FFF","#20068FFF","#210690FF","#220690FF","#230691FF","#240691FF","#250591FF","#260591FF","#270592FF","#280592FF","#2A0593FF","#2B0593FF","#2C0594FF","#2D0594FF","#2E0595FF","#2E0595FF","#2F0596FF","#300596FF","#310597FF","#320597FF","#330597FF","#340597FF","#350498FF","#360498FF","#370499FF","#370499FF","#38049AFF","#39049AFF","#3A049AFF","#3B049AFF","#3C049BFF","#3D049CFF","#3E049CFF","#3F049CFF","#3F049CFF","#40049CFF","#41049DFF","#42039EFF","#43039EFF","#44039EFF","#44039EFF","#45039FFF","#46039FFF","#47039FFF","#48039FFF","#4903A0FF","#4903A0FF","#4A03A1FF","#4B03A1FF","#4C02A1FF","#4C02A1FF","#4D02A2FF","#4F02A2FF","#5002A2FF","#5002A2FF","#5102A3FF","#5102A3FF","#5202A3FF","#5402A3FF","#5502A4FF","#5502A4FF","#5601A4FF","#5701A4FF","#5801A4FF","#5801A4FF","#5901A5FF","#5A01A5FF","#5B01A5FF","#5B01A5FF","#5C01A6FF","#5D01A6FF","#5E01A6FF","#5F01A6FF","#6001A6FF","#6001A6FF","#6100A7FF","#6200A7FF","#6300A7FF","#6300A7FF","#6400A7FF","#6500A7FF","#6600A7FF","#6700A8FF","#6700A8FF","#6800A8FF","#6900A8FF","#6A00A8FF","#6A00A8FF","#6B00A8FF","#6C00A8FF","#6D00A8FF","#6E00A8FF","#6F00A8FF","#6F00A8FF","#7000A8FF","#7100A8FF","#7201A8FF","#7201A8FF","#7301A8FF","#7401A8FF","#7501A8FF","#7501A8FF","#7701A8FF","#7701A8FF","#7801A8FF","#7901A8FF","#7A02A8FF","#7A02A8FF","#7B02A8FF","#7C02A8FF","#7D03A8FF","#7D03A8FF","#7E03A8FF","#7F03A8FF","#8004A8FF","#8004A8FF","#8104A7FF","#8204A7FF","#8305A7FF","#8305A7FF","#8405A7FF","#8505A7FF","#8606A6FF","#8707A6FF","#8707A6FF","#8708A6FF","#8808A6FF","#8909A5FF","#8A09A5FF","#8B0AA5FF","#8B0AA5FF","#8C0BA5FF","#8D0BA5FF","#8E0CA4FF","#8E0CA4FF","#8E0DA4FF","#8F0DA4FF","#900EA3FF","#910EA3FF","#920FA3FF","#920FA3FF","#9310A2FF","#9410A2FF","#9511A1FF","#9511A1FF","#9613A1FF","#9613A1FF","#9814A0FF","#9814A0FF","#99159FFF","#99159FFF","#9A169FFF","#9B169FFF","#9C179EFF","#9C179EFF","#9D189DFF","#9D189DFF","#9E199DFF","#9F199DFF","#A01A9CFF","#A11A9CFF","#A11B9BFF","#A11C9AFF","#A21D9AFF","#A21E9AFF","#A31E9AFF","#A41E9AFF","#A51F99FF","#A62098FF","#A62098FF","#A72197FF","#A72197FF","#A72296FF","#A82296FF","#A92395FF","#AA2395FF","#AB2394FF","#AB2494FF","#AC2594FF","#AC2694FF","#AD2793FF","#AD2793FF","#AE2892FF","#AE2892FF","#AF2991FF","#B02991FF","#B12A90FF","#B12A90FF","#B22B8FFF","#B22B8FFF","#B32C8EFF","#B32C8EFF","#B42E8DFF","#B42E8DFF","#B52F8CFF","#B52F8CFF","#B6308BFF","#B6308BFF","#B7318AFF","#B7318AFF","#B83289FF","#B93289FF","#BA3388FF","#BA3388FF","#BB3488FF","#BB3488FF","#BC3587FF","#BC3687FF","#BD3786FF","#BD3886FF","#BE3885FF","#BE3885FF","#BF3984FF","#BF3984FF","#C03A83FF","#C13B82FF","#C13B82FF","#C23C81FF","#C23C81FF","#C33D80FF","#C33D80FF","#C43D7FFF","#C43E7FFF","#C53F7EFF","#C5407EFF","#C6417DFF","#C6417DFF","#C7427CFF","#C7427CFF","#C8437BFF","#C8437BFF","#C9447AFF","#C9447AFF","#CA457AFF","#CA457AFF","#CB4679FF","#CB4679FF","#CC4778FF","#CC4878FF","#CC4977FF","#CC4977FF","#CD4A76FF","#CD4A76FF","#CE4B75FF","#CE4B75FF","#CF4C74FF","#CF4C74FF","#D04D73FF","#D04D73FF","#D14E72FF","#D14E72FF","#D24F71FF","#D25071FF","#D35171FF","#D35271FF","#D45270FF","#D55270FF","#D5536FFF","#D5536FFF","#D5546EFF","#D5556DFF","#D6556DFF","#D7566CFF","#D7566CFF","#D8576BFF","#D8576BFF","#D9576AFF","#D9586AFF","#DA596AFF","#DA5A6AFF","#DA5B69FF","#DA5B69FF","#DB5C68FF","#DB5C68FF","#DC5D67FF","#DC5D67FF","#DD5E66FF","#DD5E66FF","#DE5F65FF","#DE5F65FF","#DE6064FF","#DE6164FF","#DF6263FF","#DF6263FF","#E06363FF","#E06363FF","#E16462FF","#E16462FF","#E26561FF","#E26561FF","#E26660FF","#E26760FF","#E3685FFF","#E3685FFF","#E4695EFF","#E4695EFF","#E56A5DFF","#E56A5DFF","#E56B5DFF","#E56B5DFF","#E66C5CFF","#E76D5CFF","#E76E5BFF","#E76F5BFF","#E76F5AFF","#E76F59FF","#E87059FF","#E97159FF","#E97158FF","#E97157FF","#E97257FF","#E97357FF","#EA7457FF","#EB7556FF","#EB7556FF","#EB7655FF","#EB7655FF","#EC7754FF","#EC7754FF","#ED7853FF","#ED7953FF","#ED7A52FF","#ED7A52FF","#EE7B51FF","#EE7B51FF","#EF7C51FF","#EF7C51FF","#EF7E50FF","#EF7E50FF","#F07F4FFF","#F07F4FFF","#F0804EFF","#F0804EFF","#F1814DFF","#F1824DFF","#F1834CFF","#F1834CFF","#F2844BFF","#F2844BFF","#F3854BFF","#F3864BFF","#F3874AFF","#F3884AFF","#F48849FF","#F48849FF","#F48948FF","#F48A48FF","#F58B47FF","#F58C47FF","#F58C46FF","#F58C46FF","#F68D45FF","#F68E44FF","#F68F44FF","#F79044FF","#F79044FF","#F79044FF","#F79143FF","#F79242FF","#F79342FF","#F89441FF","#F89441FF","#F89440FF","#F89540FF","#F9963FFF","#F9973FFF","#F9983EFF","#F9983EFF","#F9993EFF","#F99A3EFF","#FA9B3DFF","#FA9B3DFF","#FA9C3CFF","#FA9C3CFF","#FA9E3BFF","#FA9E3BFF","#FB9F3AFF","#FBA03AFF","#FBA139FF","#FBA139FF","#FBA238FF","#FBA238FF","#FCA338FF","#FCA438FF","#FCA537FF","#FCA537FF","#FCA636FF","#FCA736FF","#FCA835FF","#FCA835FF","#FCA934FF","#FCAA33FF","#FDAB33FF","#FDAB33FF","#FDAC33FF","#FDAD33FF","#FDAE32FF","#FDAF31FF","#FDAF31FF","#FDB030FF","#FDB130FF","#FDB22FFF","#FDB22FFF","#FDB32FFF","#FDB42FFF","#FDB52EFF","#FDB52EFF","#FEB62DFF","#FEB72DFF","#FEB82CFF","#FEB82CFF","#FEB92CFF","#FEBA2CFF","#FEBB2BFF","#FEBB2BFF","#FEBC2AFF","#FEBD2AFF","#FEBE2AFF","#FEBE2AFF","#FEBF29FF","#FEC129FF","#FDC229FF","#FDC229FF","#FDC328FF","#FDC428FF","#FDC527FF","#FDC527FF","#FDC627FF","#FDC727FF","#FDC827FF","#FDC927FF","#FDCA26FF","#FDCA26FF","#FDCB26FF","#FDCC26FF","#FCCD25FF","#FCCD25FF","#FCCE25FF","#FCCF25FF","#FCD025FF","#FCD125FF","#FCD225FF","#FBD324FF","#FBD324FF","#FBD424FF","#FBD524FF","#FBD624FF","#FBD724FF","#FAD824FF","#FAD824FF","#FAD924FF","#FADA24FF","#F9DB24FF","#F9DC24FF","#F9DD25FF","#F9DD25FF","#F8DE25FF","#F8DF25FF","#F8E125FF","#F8E125FF","#F7E225FF","#F7E225FF","#F7E325FF","#F7E525FF","#F6E626FF","#F6E726FF","#F6E826FF","#F6E826FF","#F5E926FF","#F5EA26FF","#F5EB27FF","#F5EC27FF","#F4ED27FF","#F4ED27FF","#F3EE27FF","#F3EF27FF","#F3F027FF","#F3F127FF","#F2F227FF","#F1F327FF","#F1F426FF","#F1F426FF","#F1F525FF","#F1F625FF","#F0F724FF","#F0F823FF","#F0F921FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"marker":{"color":"#00aaff","size":10},"type":"scatter3d","showlegend":false,"inherit":true}},"layout":{"width":750,"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"zeroline":false,"showgrid":false},"yaxis":{"zeroline":false,"showgrid":false},"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","scene":{"xaxis":{"title":"mu","titlefont":{"size":12},"tickfont":{"size":10},"dtick":0.25},"yaxis":{"title":"sigma","titlefont":{"size":12},"tickfont":{"size":10},"dtick":0.25},"zaxis":{"title":"Neg. Log Lik ","titlefont":{"size":8},"tickfont":{"size":10},"position":0.1}},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"llsurf_trans<br />ll","ticklen":2},"colorscale":[["0","rgba(13,8,135,1)"],["0.0416666666666668","rgba(39,5,146,1)"],["0.0833333333333336","rgba(59,4,154,1)"],["0.125","rgba(76,2,161,1)"],["0.166666666666667","rgba(93,1,166,1)"],["0.208333333333334","rgba(110,0,168,1)"],["0.250000000000001","rgba(126,3,168,1)"],["0.291666666666666","rgba(142,12,164,1)"],["0.333333333333333","rgba(156,23,158,1)"],["0.375","rgba(169,35,149,1)"],["0.416666666666666","rgba(181,47,140,1)"],["0.458333333333333","rgba(193,59,130,1)"],["0.5","rgba(204,71,121,1)"],["0.541666666666667","rgba(213,83,111,1)"],["0.583333333333334","rgba(222,95,101,1)"],["0.625","rgba(229,107,93,1)"],["0.666666666666667","rgba(237,121,83,1)"],["0.708333333333334","rgba(243,134,75,1)"],["0.749999999999999","rgba(248,148,65,1)"],["0.791666666666667","rgba(252,163,56,1)"],["0.833333333333333","rgba(253,179,47,1)"],["0.875","rgba(253,196,40,1)"],["0.916666666666666","rgba(251,212,36,1)"],["0.958333333333333","rgba(246,231,38,1)"],["1","rgba(240,249,33,1)"]],"showscale":false,"x":[4,4.04081632653061,4.08163265306122,4.12244897959184,4.16326530612245,4.20408163265306,4.24489795918367,4.28571428571429,4.3265306122449,4.36734693877551,4.40816326530612,4.44897959183673,4.48979591836735,4.53061224489796,4.57142857142857,4.61224489795918,4.6530612244898,4.69387755102041,4.73469387755102,4.77551020408163,4.81632653061224,4.85714285714286,4.89795918367347,4.93877551020408,4.97959183673469,5.02040816326531,5.06122448979592,5.10204081632653,5.14285714285714,5.18367346938776,5.22448979591837,5.26530612244898,5.30612244897959,5.3469387755102,5.38775510204082,5.42857142857143,5.46938775510204,5.51020408163265,5.55102040816327,5.59183673469388,5.63265306122449,5.6734693877551,5.71428571428571,5.75510204081633,5.79591836734694,5.83673469387755,5.87755102040816,5.91836734693878,5.95918367346939,6],"y":[1.5,1.53061224489796,1.56122448979592,1.59183673469388,1.62244897959184,1.6530612244898,1.68367346938776,1.71428571428571,1.74489795918367,1.77551020408163,1.80612244897959,1.83673469387755,1.86734693877551,1.89795918367347,1.92857142857143,1.95918367346939,1.98979591836735,2.02040816326531,2.05102040816327,2.08163265306122,2.11224489795918,2.14285714285714,2.1734693877551,2.20408163265306,2.23469387755102,2.26530612244898,2.29591836734694,2.3265306122449,2.35714285714286,2.38775510204082,2.41836734693878,2.44897959183673,2.47959183673469,2.51020408163265,2.54081632653061,2.57142857142857,2.60204081632653,2.63265306122449,2.66326530612245,2.69387755102041,2.72448979591837,2.75510204081633,2.78571428571429,2.81632653061224,2.8469387755102,2.87755102040816,2.90816326530612,2.93877551020408,2.96938775510204,3],"z":[[2406.89081333282,2390.08541769164,2374.02045427777,2358.69592309122,2344.11182413198,2330.26815740005,2317.16492289544,2304.80212061813,2293.17975056814,2282.29781274547,2272.1563071501,2262.75523378205,2254.09459264131,2246.17438372789,2238.99460704177,2232.55526258297,2226.85635035149,2221.89787034731,2217.67982257045,2214.2022070209,2211.46502369866,2209.46827260374,2208.21195373612,2207.69606709582,2207.92061268284,2208.88559049716,2210.5910005388,2213.03684280775,2216.22311730402,2220.1498240276,2224.81696297849,2230.22453415669,2236.3725375622,2243.26097319503,2250.88984105517,2259.25914114262,2268.36887345739,2278.21903799947,2288.80963476886,2300.14066376556,2312.21212498958,2325.02401844091,2338.57634411955,2352.86910202551,2367.90229215877,2383.67591451935,2400.18996910725,2417.44445592245,2435.43937496497,2454.1747262348],[2384.22702863835,2368.08712666456,2352.65833580188,2337.94065605032,2323.93408740986,2310.63862988052,2298.05428346229,2286.18104815516,2275.01892395915,2264.56791087426,2254.82800890047,2245.79921803779,2237.48153828623,2229.87496964577,2222.97951211643,2216.7951656982,2211.32193039107,2206.55980619506,2202.50879311017,2199.16889113638,2196.5401002737,2194.62242052214,2193.41585188168,2192.92039435234,2193.13604793411,2194.06281262698,2195.70068843097,2198.04967534608,2201.10977337229,2204.88098250961,2209.36330275805,2214.55673411759,2220.46127658825,2227.07693017002,2234.40369486289,2242.44157066688,2251.19055758199,2260.6506556082,2270.82186474552,2281.70418499396,2293.2976163535,2305.60215882416,2318.61781240593,2332.3445770988,2346.78245290279,2361.9314398179,2377.79153784411,2394.36274698143,2411.64506722987,2429.63849858941],[2363.65991787962,2348.14674797017,2333.31707586072,2319.17090155126,2305.70822504178,2292.9290463323,2280.83336542282,2269.42118231332,2258.69249700381,2248.6473094943,2239.28561978477,2230.60742787524,2222.6127337657,2215.30153745615,2208.6738389466,2202.72963823703,2197.46893532746,2192.89173021787,2188.99802290828,2185.78781339868,2183.26110168907,2181.41788777946,2180.25817166983,2179.7819533602,2179.98923285055,2180.8800101409,2182.45428523124,2184.71205812158,2187.6533288119,2191.27809730221,2195.58636359252,2200.57812768282,2206.25338957311,2212.61214926339,2219.65440675366,2227.38016204392,2235.78941513418,2244.88216602442,2254.65841471466,2265.11816120489,2276.26140549511,2288.08814758532,2300.59838747553,2313.79212516572,2327.66936065591,2342.23009394609,2357.47432503625,2373.40205392642,2390.01328061657,2407.30800510671],[2345.01482066676,2330.0925740194,2315.82778956796,2302.22046731245,2289.27060725285,2276.97820938919,2265.34327372144,2254.36580024962,2244.04578897372,2234.38323989375,2225.3781530097,2217.03052832158,2209.34036582937,2202.3076655331,2195.93242743274,2190.21465152831,2185.1543378198,2180.75148630722,2177.00609699056,2173.91816986983,2171.48770494501,2169.71470221613,2168.59916168316,2168.14108334612,2168.340467205,2169.19731325981,2170.71162151054,2172.88339195719,2175.71262459977,2179.19931943827,2183.3434764727,2188.14509570305,2193.60417712932,2199.72072075152,2206.49472656964,2213.92619458368,2222.01512479365,2230.76151719954,2240.16537180136,2250.2266885991,2260.94546759276,2272.32170878234,2284.35541216785,2297.04657774929,2310.39520552665,2324.40129549993,2339.06484766913,2354.38586203426,2370.36433859531,2387.00027735229],[2328.13396092663,2313.76950562778,2300.03793668627,2286.93925410211,2274.47345787529,2262.64054800581,2251.44052449368,2240.87338733889,2230.93913654144,2221.63777210134,2212.96929401858,2204.93370229317,2197.5309969251,2190.76117791437,2184.62424526098,2179.12019896494,2174.24903902624,2170.01076544489,2166.40537822088,2163.43287735421,2161.09326284488,2159.3865346929,2158.31269289827,2157.87173746097,2158.06366838102,2158.88848565842,2160.34618929315,2162.43677928523,2165.16025563466,2168.51661834142,2172.50586740553,2177.12800282699,2182.38302460578,2188.27093274192,2194.79172723541,2201.94540808624,2209.73197529441,2218.15142885992,2227.20376878278,2236.88899506298,2247.20710770053,2258.15810669542,2269.74199204765,2281.95876375722,2294.80842182414,2308.2909662484,2322.40639703001,2337.15471416896,2352.53591766525,2368.55000751889],[2312.87455712587,2299.03719260788,2285.80949125099,2273.1914530552,2261.18307802052,2249.78436614694,2238.99531743446,2228.81593188309,2219.24620949282,2210.28615026365,2201.93575419559,2194.19502128863,2187.06395154278,2180.54254495803,2174.63080153438,2169.32872127183,2164.63630417039,2160.55355023005,2157.08045945082,2154.21703183269,2151.96326737566,2150.31916607974,2149.28472794492,2148.8599529712,2149.04484115859,2149.83939250708,2151.24360701667,2153.25748468737,2155.88102551917,2159.11422951207,2162.95709666608,2167.40962698119,2172.47182045741,2178.14367709472,2184.42519689315,2191.31637985267,2198.8172259733,2206.92773525503,2215.64790769787,2224.97774330181,2234.91724206685,2245.46640399299,2256.62522908024,2268.3937173286,2280.77186873805,2293.75968330861,2307.35716104028,2321.56430193304,2336.38110598691,2351.80757320189],[2299.10717306938,2285.76841110758,2273.01734427892,2260.85397258341,2249.27829602105,2238.29031459184,2227.89002829578,2218.07743713287,2208.85254110311,2200.2153402065,2192.16583444304,2184.70402381273,2177.82990831556,2171.54348795155,2165.84476272069,2160.73373262298,2156.21039765841,2152.274757827,2148.92681312874,2146.16656356362,2143.99400913166,2142.40914983285,2141.41198566718,2141.00251663467,2141.1807427353,2141.94666396908,2143.30028033602,2145.2415918361,2147.77059846934,2150.88730023572,2154.59169713525,2158.88378916793,2163.76357633376,2169.23105863275,2175.28623606488,2181.92910863016,2189.15967632859,2196.97793916017,2205.3838971249,2214.37755022278,2223.95889845381,2234.12794181799,2244.88468031532,2256.2291139458,2268.16124270942,2280.6810666062,2293.78858563613,2307.48379979921,2321.76670909543,2336.63731352481],[2286.71427501516,2273.84764397738,2261.54790636364,2249.81506217393,2238.64911140827,2228.05005406663,2218.01789014904,2208.55261965548,2199.65424258595,2191.32275894047,2183.55816871902,2176.3604719216,2169.72966854822,2163.66575859888,2158.16874207358,2153.23861897231,2148.87538929507,2145.07905304188,2141.84961021272,2139.18706080759,2137.09140482651,2135.56264226945,2134.60077313644,2134.20579742746,2134.37771514252,2135.11652628161,2136.42223084474,2138.29482883191,2140.73432024311,2143.74070507835,2147.31398333762,2151.45415502093,2156.16122012828,2161.43517865966,2167.27603061508,2173.68377599454,2180.65841479803,2188.19994702556,2196.30837267713,2204.98369175273,2214.22590425237,2224.03501017604,2234.41100952375,2245.3539022955,2256.86368849128,2268.9403681111,2281.58394115495,2294.79440762285,2308.57176751477,2322.91602083074],[2275.58896622912,2263.1698357476,2251.29788217521,2239.97310551195,2229.19550575783,2218.96508291285,2209.281836977,2200.14576795028,2191.5568758327,2183.51516062425,2176.02062232493,2169.07326093476,2162.67307645371,2156.8200688818,2151.51423821903,2146.75558446538,2142.54410762088,2138.8798076855,2135.76268465927,2133.19273854216,2131.16996933419,2129.69437703536,2128.76596164566,2128.38472316509,2128.55066159366,2129.26377693137,2130.5240691782,2132.33153833417,2134.68618439928,2137.58800737352,2141.0370072569,2145.03318404941,2149.57653775105,2154.66706836183,2160.30477588174,2166.48966031079,2173.22172164897,2180.50095989629,2188.32737505274,2196.70096711832,2205.62173609304,2215.0896819769,2225.10480476989,2235.66710447201,2246.77658108327,2258.43323460366,2270.63706503318,2283.38807237184,2296.68625661964,2310.53161777657],[2265.63387456313,2253.63929818546,2242.17319320428,2231.23555961959,2220.82639743138,2210.94570663965,2201.59348724442,2192.76973924566,2184.4744626434,2176.70765743762,2169.46932362832,2162.75946121551,2156.57807019919,2150.92515057935,2145.800702356,2141.20472552913,2137.13722009875,2133.59818606485,2130.58762342744,2128.10553218652,2126.15191234208,2124.72676389413,2123.83008684266,2123.46188118768,2123.62214692918,2124.31088406717,2125.52809260165,2127.27377253261,2129.54792386005,2132.35054658399,2135.6816407044,2139.54120622131,2143.9292431347,2148.84575144457,2154.29073115093,2160.26418225378,2166.76610475311,2173.79649864893,2181.35536394123,2189.44270063002,2198.05850871529,2207.20278819706,2216.8755390753,2227.07676135003,2237.80645502125,2249.06462008895,2260.85125655314,2273.16636441382,2286.00994367098,2299.38199432462],[2256.7601723478,2245.16874605234,2234.08802868472,2223.51802024493,2213.45872073297,2203.91013014884,2194.87224849254,2186.34507576407,2178.32861196343,2170.82285709062,2163.82781114564,2157.34347412849,2151.36984603918,2145.90692687769,2140.95471664403,2136.51321533821,2132.58242296021,2129.16233951005,2126.25296498771,2123.85429939321,2121.96634272653,2120.58909498769,2119.72255617668,2119.3667262935,2119.52160533814,2120.18719331062,2121.36349021093,2123.05049603907,2125.24821079504,2127.95663447884,2131.17576709047,2134.90560862993,2139.14615909722,2143.89741849234,2149.1593868153,2154.93206406608,2161.21545024469,2168.00954535114,2175.31434938541,2183.12986234752,2191.45608423745,2200.29301505522,2209.64065480081,2219.49900347424,2229.8680610755,2240.74782760458,2252.1383030615,2264.03948744625,2276.45138075883,2289.37398299924],[2248.88671098541,2237.67844572584,2226.96400762676,2216.74339668817,2207.01661291008,2197.78365629248,2189.04452683537,2180.79922453876,2173.04774940264,2165.79010142702,2159.02628061189,2152.75628695725,2146.98012046311,2141.69778112946,2136.9092689563,2132.61458394364,2128.81372609148,2125.5066953998,2122.69349186862,2120.37411549794,2118.54856628774,2117.21684423805,2116.37894934884,2116.03488162013,2116.18464105191,2116.82822764419,2117.96564139696,2119.59688231023,2121.72195038399,2124.34084561824,2127.45356801298,2131.06011756822,2135.16049428396,2139.75469816019,2144.84272919691,2150.42458739412,2156.50027275183,2163.06978527003,2170.13312494873,2177.69029178792,2185.74128578761,2194.28610694778,2203.32475526846,2212.85723074962,2222.88353339128,2233.40366319344,2244.41762015608,2255.92540427922,2267.92701556286,2280.42245400699],[2241.93925521749,2231.09546189998,2220.72943740208,2210.84118172379,2201.43069486511,2192.49797682605,2184.04302760659,2176.06584720676,2168.56643562653,2161.54479286591,2155.00091892491,2148.93481380352,2143.34647750174,2138.23591001958,2133.60311135703,2129.44808151409,2125.77082049076,2122.57132828704,2119.84960490294,2117.60565033845,2115.83946459357,2114.55104766831,2113.74039956265,2113.40752027661,2113.55240981018,2114.17506816337,2115.27549533616,2116.85369132857,2118.90965614059,2121.44338977223,2124.45489222347,2127.94416349433,2131.9112035848,2136.35601249488,2141.27859022458,2146.67893677389,2152.55705214281,2158.91293633134,2165.74658933949,2173.05801116724,2180.84720181461,2189.1141612816,2197.85888956819,2207.0813866744,2216.78165260022,2226.95968734565,2237.61549091069,2248.74906329535,2260.36040449962,2272.4495145235],[2235.84980421504,2225.35298971596,2215.31865642857,2205.74680435289,2196.63743348892,2187.99054383664,2179.80613539606,2172.08420816718,2164.82476215001,2158.02779734453,2151.69331375076,2145.82131136868,2140.41179019831,2135.46475023964,2130.98019149267,2126.95811395739,2123.39851763383,2120.30140252196,2117.66676862179,2115.49461593332,2113.78494445655,2112.53775419149,2111.75304513812,2111.43081729646,2111.57107066649,2112.17380524823,2113.23902104167,2114.76671804681,2116.75689626365,2119.20955569219,2122.12469633243,2125.50231818437,2129.34242124801,2133.64500552335,2138.4100710104,2143.63761770914,2149.32764561959,2155.48015474174,2162.09514507558,2169.17261662113,2176.71256937838,2184.71500334733,2193.17991852798,2202.10731492033,2211.49719252438,2221.34955134013,2231.66439136759,2242.44171260674,2253.6815150576,2265.38379872015],[2230.55598847003,2220.38976147722,2210.67145027624,2201.40105486709,2192.57857524977,2184.20401142428,2176.27736339062,2168.7986311488,2161.76781469881,2155.18491404064,2149.04992917431,2143.36286009981,2138.12370681714,2133.3324693263,2128.9891476273,2125.09374172012,2121.64625160478,2118.64667728126,2116.09501874958,2113.99127600973,2112.33544906171,2111.12753790552,2110.36754254116,2110.05546296864,2110.19129918794,2110.77505119908,2111.80671900204,2113.28630259684,2115.21380198347,2117.58921716193,2120.41254813222,2123.68379489434,2127.4029574483,2131.57003579408,2136.1850299317,2141.24793986115,2146.75876558242,2152.71750709553,2159.12416440047,2165.97873749724,2173.28122638585,2181.03163106628,2189.22995153855,2197.87618780264,2206.97033985857,2216.51240770633,2226.50239134592,2236.94029077734,2247.82610600059,2259.15983701567],[2226.00053301207,2216.14951862377,2206.73253201325,2197.74957318051,2189.20064212554,2181.08573884836,2173.40486334895,2166.15801562732,2159.34519568346,2152.96640351739,2147.02163912909,2141.51090251857,2136.43419368583,2131.79151263086,2127.58285935367,2123.80823385426,2120.46763613263,2117.56106618878,2115.0885240227,2113.0500096344,2111.44552302388,2110.27506419114,2109.53863313618,2109.23622985899,2109.36785435958,2109.93350663795,2110.9331866941,2112.36689452802,2114.23463013972,2116.5363935292,2119.27218469646,2122.44200364149,2126.04585036431,2130.0837248649,2134.55562714327,2139.46155719941,2144.80151503334,2150.57550064504,2156.78351403452,2163.42555520177,2170.50162414681,2178.01172086962,2185.95584537021,2194.33399764858,2203.14617770473,2212.39238553865,2222.07262115035,2232.18688453983,2242.73517570709,2253.71749465213],[2222.13077878305,2212.58054092874,2203.45107887981,2194.74239263628,2186.45448219815,2178.5873475654,2171.14098873804,2164.11540571608,2157.5105984995,2151.32656708832,2145.56331148253,2140.22083168213,2135.29912768712,2130.7981994975,2126.71804711327,2123.05867053444,2119.82006976099,2117.00224479294,2114.60519563028,2112.62892227301,2111.07342472113,2109.93870297464,2109.22475703354,2108.93158689784,2109.05919256752,2109.6075740426,2110.57673132307,2111.96666440892,2113.77737330017,2116.00885799681,2118.66111849885,2121.73415480627,2125.22796691908,2129.14255483729,2133.47791856089,2138.23405808988,2143.41097342426,2149.00866456403,2155.02713150919,2161.46637425974,2168.32639281568,2175.60718717702,2183.30875734375,2191.43110331586,2199.97422509337,2208.93812267627,2218.32279606456,2228.12824525825,2238.35447025732,2249.00147106179],[2218.89825511385,2209.6352259737,2200.7803184538,2192.33353255414,2184.29486827472,2176.66432561555,2169.44190457662,2162.62760515793,2156.22142735949,2150.22337118129,2144.63343662333,2139.45162368561,2134.67793236814,2130.31236267091,2126.35491459392,2122.80558813718,2119.66438330067,2116.93130008441,2114.6063384884,2112.68949851262,2111.18078015709,2110.08018342181,2109.38770830676,2109.10335481196,2109.2271229374,2109.75901268308,2110.69902404901,2112.04715703518,2113.80341164159,2115.96778786825,2118.54028571514,2121.52090518228,2124.90964626967,2128.70650897729,2132.91149330516,2137.52459925327,2142.54582682163,2147.97517601023,2153.81264681907,2160.05823924815,2166.71195329747,2173.77378896704,2181.24374625686,2189.12182516691,2197.40802569721,2206.10234784775,2215.20479161853,2224.71535700956,2234.63404402082,2244.96085265234],[2216.2582971933,2207.26971289068,2198.6771583893,2190.48063368917,2182.68013879027,2175.27567369262,2168.26723839621,2161.65483290104,2155.43845720712,2149.61811131444,2144.193795223,2139.1655089328,2134.53325244385,2130.29702575614,2126.45682886967,2123.01266178444,2119.96452450046,2117.31241701772,2115.05633933622,2113.19629145596,2111.73227337695,2110.66428509918,2109.99232662265,2109.71639794737,2109.83649907332,2110.35263000052,2111.26479072896,2112.57298125865,2114.27720158957,2116.37745172174,2118.87373165516,2121.76604138981,2125.05438092571,2128.73875026285,2132.81914940123,2137.29557834085,2142.16803708172,2147.43652562383,2153.10104396718,2159.16159211178,2165.61817005761,2172.47077780469,2179.71941535302,2187.36408270258,2195.40477985339,2203.84150680544,2212.67426355873,2221.90305011327,2231.52786646904,2241.54871262607],[2214.16970322693,2205.44354515286,2197.1018545913,2189.14463154222,2181.57187600564,2174.38358798156,2167.57976746997,2161.16041447088,2155.12552898428,2149.47511101018,2144.20916054858,2139.32767759946,2134.83066216285,2130.71811423873,2126.9900338271,2123.64642092797,2120.68727554134,2118.11259766719,2115.92238730555,2114.1166444564,2112.69536911975,2111.65856129559,2111.00622098392,2110.73834818475,2110.85494289808,2111.3560051239,2112.24153486222,2113.51153211303,2115.16599687633,2117.20492915214,2119.62832894043,2122.43619624123,2125.62853105451,2129.2053333803,2133.16660321857,2137.51234056935,2142.24254543261,2147.35721780838,2152.85635769664,2158.73996509739,2165.00804001064,2171.66058243638,2178.69759237462,2186.11906982536,2193.92501478859,2202.11542726431,2210.69030725253,2219.64965475325,2228.99346976646,2238.72175229217],[2212.59442667365,2204.11936787624,2196.01771335898,2188.28946312186,2180.93461716489,2173.95317548807,2167.34513809139,2161.11050497486,2155.24927613847,2149.76145158224,2144.64703130614,2139.9060153102,2135.5384035944,2131.54419615875,2127.92339300325,2124.67599412789,2121.80199953268,2119.30140921761,2117.17422318269,2115.42044142792,2114.04006395329,2113.03309075882,2112.39952184448,2112.1393572103,2112.25259685626,2112.73924078237,2113.59928898862,2114.83274147502,2116.43959824157,2118.41985928826,2120.7735246151,2123.50059422209,2126.60106810922,2130.0749462765,2133.92222872393,2138.1429154515,2142.73700645922,2147.70450174709,2153.0454013151,2158.75970516326,2164.84741329156,2171.30852570002,2178.14304238862,2185.35096335736,2192.93228860625,2200.88701813529,2209.21515194448,2217.91669003381,2226.99163240329,2236.43997905291],[2211.49729954136,2203.26265567718,2195.39082360439,2187.88180332298,2180.73559483295,2173.9521981343,2167.53161322704,2161.47384011117,2155.77887878667,2150.44672925356,2145.47739151183,2140.87086556149,2136.62715140252,2132.74624903494,2129.22815845875,2126.07287967394,2123.28041268051,2120.85075747846,2118.7839140678,2117.07988244852,2115.73866262062,2114.76025458411,2114.14465833898,2113.89187388523,2114.00190122287,2114.47474035189,2115.31039127229,2116.50885398408,2118.07012848725,2119.9942147818,2122.28111286774,2124.93082274506,2127.94334441376,2131.31867787384,2135.05682312531,2139.15778016817,2143.6215490024,2148.44812962802,2153.63752204502,2159.18972625341,2165.10474225317,2171.38257004433,2178.02320962686,2185.02666100078,2192.39292416608,2200.12199912276,2208.21388587083,2216.66858441028,2225.48609474111,2234.66641686333],[2210.84578323102,2202.84146763204,2195.18981574617,2187.8908275734,2180.94450311374,2174.35084236719,2168.10984533375,2162.22151201342,2156.68584240619,2151.50283651207,2146.67249433106,2142.19481586316,2138.06980110837,2134.29745006668,2130.87776273811,2127.81073912264,2125.09637922028,2122.73468303102,2120.72565055488,2119.06928179184,2117.76557674191,2116.81453540509,2116.21615778138,2115.97044387077,2116.07739367328,2116.53700718889,2117.34928441761,2118.51422535943,2120.03183001437,2121.90209838241,2124.12503046357,2126.70062625783,2129.62888576519,2132.90980898567,2136.54339591925,2140.52964656595,2144.86856092575,2149.56013899865,2154.60438078467,2160.0012862838,2165.75085549603,2171.85308842137,2178.30798505982,2185.11554541137,2192.27576947604,2199.78865725381,2207.65420874469,2215.87242394868,2224.44330286578,2233.36684549598],[2210.60974385792,2202.82622631655,2195.3856443033,2188.28799781817,2181.53328686116,2175.12151143227,2169.0526715315,2163.32676715886,2157.94379831433,2152.90376499792,2148.20666720964,2143.85250494947,2139.84127821743,2136.17298701351,2132.84763133771,2129.86521119002,2127.22572657046,2124.92917747902,2122.9755639157,2121.36488588051,2120.09714337343,2119.17233639447,2118.59046494363,2118.35152902092,2118.45552862632,2118.90246375985,2119.6923344215,2120.82514061126,2122.30088232915,2124.11955957516,2126.28117234929,2128.78572065154,2131.63320448191,2134.8236238404,2138.35697872701,2142.23326914175,2146.4524950846,2151.01465655557,2155.91975355467,2161.16778608188,2166.75875413722,2172.69265772068,2178.96949683226,2185.58927147195,2192.55198163977,2199.85762733571,2207.50620855977,2215.49772531196,2223.83217759226,2232.50956540068],[2210.76124935716,2203.18951827545,2195.95139158063,2189.04686927271,2182.47595135168,2176.23863781756,2170.33492867033,2164.76482391,2159.52832353656,2154.62542755003,2150.05613595039,2145.82044873765,2141.91836591181,2138.34988747286,2135.11501342082,2132.21374375567,2129.64607847742,2127.41201758606,2125.51156108161,2123.94470896405,2122.71146123339,2121.81181788962,2121.24577893276,2121.01334436279,2121.11451417972,2121.54928838355,2122.31766697427,2123.4196499519,2124.85523731642,2126.62442906784,2128.72722520615,2131.16362573136,2133.93363064348,2137.03723994249,2140.47445362839,2144.2452717012,2148.3496941609,2152.7877210075,2157.559352241,2162.66458786139,2168.10342786868,2173.87587226287,2179.98192104396,2186.42157421195,2193.19483176683,2200.30169370861,2207.74216003729,2215.51623075287,2223.62390585534,2232.06518534472],[2211.27438600827,2203.90591359511,2196.86209015525,2190.14291568868,2183.74839019542,2177.67851367545,2171.93328612877,2166.5127075554,2161.41677795532,2156.64549732854,2152.19886567506,2148.07688299487,2144.27954928799,2140.8068645544,2137.6588287941,2134.83544200711,2132.33670419341,2130.16261535301,2128.31317548591,2126.78838459211,2125.5882426716,2124.71274972439,2124.16190575048,2123.93571074987,2124.03416472256,2124.45726766854,2125.20501958782,2126.27742048039,2127.67447034627,2129.39616918544,2131.44251699791,2133.81351378368,2136.50915954274,2139.52945427511,2142.87439798077,2146.54399065973,2150.53823231198,2154.85712293753,2159.50066253639,2164.46885110853,2169.76168865398,2175.37917517272,2181.32131066477,2187.58809513011,2194.17952856874,2201.09561098068,2208.33634236591,2215.90172272444,2223.79175205627,2232.00643036139],[2212.12509229763,2204.9518025315,2198.09456214809,2191.55337114739,2185.32822952941,2179.41913729415,2173.8260944416,2168.54910097177,2163.58815688465,2158.94326218025,2154.61441685857,2150.6016209196,2146.90487436335,2143.52417718982,2140.459529399,2137.71093099089,2135.27838196551,2133.16188232284,2131.36143206288,2129.87703118564,2128.70867969112,2127.85637757931,2127.32012485022,2127.09992150385,2127.19576754019,2127.60766295924,2128.33560776102,2129.37960194551,2130.73964551271,2132.41573846263,2134.40788079527,2136.71607251063,2139.34031360869,2142.28060408948,2145.53694395298,2149.1093331992,2152.99777182813,2157.20225983978,2161.72279723415,2166.55938401123,2171.71202017103,2177.18070571354,2182.96544063877,2189.06622494672,2195.48305863738,2202.21594171076,2209.26487416685,2216.62985600567,2224.31088722719,2232.30796783143],[2213.29100828424,2206.30524738839,2199.62727350392,2193.25708663084,2187.19468676914,2181.44007391884,2175.99324807992,2170.8542092524,2166.02295743626,2161.4994926315,2157.28381483814,2153.37592405616,2149.77582028558,2146.48350352638,2143.49897377857,2140.82223104214,2138.45327531711,2136.39210660346,2134.6387249012,2133.19313021033,2132.05532253085,2131.22530186275,2130.70306820605,2130.48862156073,2130.5819619268,2130.98308930426,2131.6920036931,2132.70870509334,2134.03319350496,2135.66546892797,2137.60553136237,2139.85338080815,2142.40901726533,2145.27244073389,2148.44365121384,2151.92264870518,2155.70943320791,2159.80400472203,2164.20636324753,2168.91650878442,2173.9344413327,2179.26016089237,2184.89366746342,2190.83496104587,2197.0840416397,2203.64090924492,2210.50556386153,2217.67800548953,2225.15823412891,2232.94624977968],[2214.75133884911,2207.94584805227,2201.44020171112,2195.23439982565,2189.32844239588,2183.72232942179,2178.41606090339,2173.40963684068,2168.70305723366,2164.29632208233,2160.18943138669,2156.38238514673,2152.87518336247,2149.66782603389,2146.760313161,2144.1526447438,2141.84482078229,2139.83684127647,2138.12870622633,2136.72041563189,2135.61196949313,2134.80336781006,2134.29461058268,2134.08569781099,2134.17662949499,2134.56740563467,2135.25802623005,2136.24849128111,2137.53880078786,2139.1289547503,2141.01895316843,2143.20879604225,2145.69848337175,2148.48801515695,2151.57739139783,2154.9666120944,2158.65567724666,2162.64458685461,2166.93334091825,2171.52193943758,2176.41038241259,2181.5986698433,2187.08680172969,2192.87477807177,2198.96259886954,2205.350264123,2212.03777383214,2219.02512799698,2226.3123266175,2233.89936969371],[2216.48672939541,2209.85461977436,2203.51471557372,2197.46701679349,2191.71152343368,2186.24823549427,2181.07715297527,2176.19827587668,2171.61160419851,2167.31713794074,2163.31487710339,2159.60482168644,2156.18697168991,2153.06132711378,2150.22788795807,2147.68665422277,2145.43762590788,2143.48080301339,2141.81618553932,2140.44377348566,2139.36356685241,2138.57556563957,2138.07976984715,2137.87617947513,2137.96479452352,2138.34561499232,2139.01864088154,2139.98387219116,2141.2413089212,2142.79095107164,2144.6327986425,2146.76685163376,2149.19311004544,2151.91157387753,2154.92224313002,2158.22511780293,2161.82019789625,2165.70748340998,2169.88697434412,2174.35867069867,2179.12257247363,2184.17867966901,2189.52699228479,2195.16751032098,2201.10023377758,2207.3251626546,2213.84229695202,2220.65163666986,2227.7531818081,2235.14693236676],[2218.4791527306,2212.01388195116,2205.83346580684,2199.93790429764,2194.32719742356,2189.0013451846,2183.96034758076,2179.20420461203,2174.73291627843,2170.54648257994,2166.64490351658,2163.02817908833,2159.6963092952,2156.64929413719,2153.8871336143,2151.40982772653,2149.21737647388,2147.30977985634,2145.68703787393,2144.34915052664,2143.29611781446,2142.5279397374,2142.04461629546,2141.84614748864,2141.93253331694,2142.30377378036,2142.9598688789,2143.90081861256,2145.12662298133,2146.63728198523,2148.43279562424,2150.51316389838,2152.87838680763,2155.528464352,2158.46339653149,2161.6831833461,2165.18782479583,2168.97732088067,2173.05167160064,2177.41087695572,2182.05493694593,2186.98385157125,2192.19762083169,2197.69624472725,2203.47972325793,2209.54805642373,2215.90124422465,2222.53928666069,2229.46218373185,2236.66993543812],[2220.71180600421,2214.4071567957,2208.38028536497,2202.63119171201,2197.15987583684,2191.96633773944,2187.05057741981,2182.41259487797,2178.0523901139,2173.96996312762,2170.1653139191,2166.63844248837,2163.38934883542,2160.41803296024,2157.72449486284,2155.30873454322,2153.17075200137,2151.31054723731,2149.72812025102,2148.42347104251,2147.39659961177,2146.64750595882,2146.17619008364,2145.98265198624,2146.06689166662,2146.42890912478,2147.06870436071,2147.98627737442,2149.18162816591,2150.65475673518,2152.40566308222,2154.43434720704,2156.74080910964,2159.32504879002,2162.18706624818,2165.32686148411,2168.74443449782,2172.43978528931,2176.41291385858,2180.66382020562,2185.19250433045,2189.99896623305,2195.08320591342,2200.44522337158,2206.08501860751,2212.00259162122,2218.19794241271,2224.67107098198,2231.42197732903,2238.45066145385],[2223.16901670104,2217.01907691527,2211.14009853443,2205.53208155852,2200.19502598755,2195.12893182152,2190.33379906042,2185.80962770425,2181.55641775302,2177.57416920672,2173.86288206536,2170.42255632894,2167.25319199745,2164.35478907089,2161.72734754927,2159.37086743258,2157.28534872083,2155.47079141401,2153.92719551213,2152.65456101518,2151.65288792317,2150.9221762361,2150.46242595395,2150.27363707675,2150.35580960447,2150.70894353713,2151.33303887473,2152.22809561726,2153.39411376473,2154.83109331713,2156.53903427447,2158.51793663674,2160.76780040395,2163.28862557609,2166.08041215317,2169.14316013518,2172.47686952212,2176.081540314,2179.95717251082,2184.10376611257,2188.52132111926,2193.20983753088,2198.16931534743,2203.39975456892,2208.90115519535,2214.67351722671,2220.716840663,2227.03112550423,2233.6163717504,2240.4725794015],[2225.836156799,2219.83530091939,2214.09883792762,2208.62676782368,2203.41909060756,2198.47580627928,2193.79691483883,2189.38241628622,2185.23231062143,2181.34659784447,2177.72527795535,2174.36835095406,2171.2758168406,2168.44767561497,2165.88392727717,2163.5845718272,2161.54960926506,2159.77903959076,2158.27286280429,2157.03107890564,2156.05368789483,2155.34068977185,2154.89208453671,2154.70787218939,2154.7880527299,2155.13262615825,2155.74159247443,2156.61495167844,2157.75270377027,2159.15484874995,2160.82138661745,2162.75231737278,2164.94764101595,2167.40735754694,2170.13146696577,2173.11996927243,2176.37286446692,2179.89015254924,2183.6718335194,2187.71790737738,2192.0283741232,2196.60323375684,2201.44248627832,2206.54613168763,2211.91416998477,2217.54660116974,2223.44342524255,2229.60464220318,2236.03025205165,2242.72025478794],[2228.69956429827,2222.84243627759,2217.24336861077,2211.90236129782,2206.81941433874,2201.99452773352,2197.42770148216,2193.11893558467,2189.06823004105,2185.27558485129,2181.7410000154,2178.46447553337,2175.44601140521,2172.68560763091,2170.18326421048,2167.93898114391,2165.95275843121,2164.22459607237,2162.7544940674,2161.54245241629,2160.58847111905,2159.89255017568,2159.45468958617,2159.27488935052,2159.35314946874,2159.68946994083,2160.28385076678,2161.13629194659,2162.24679348028,2163.61535536782,2165.24197760923,2167.12666020451,2169.26940315365,2171.67020645666,2174.32907011353,2177.24599412427,2180.42097848888,2183.85402320734,2187.54512827968,2191.49429370588,2195.70151948594,2200.16680561987,2204.89015210767,2209.87155894933,2215.11102614485,2220.60855369424,2226.3641415975,2232.37778985462,2238.64949846561,2245.17926743046],[2231.74647141343,2226.02796872998,2220.56141867943,2215.34682126178,2210.38417647704,2205.6734843252,2201.21474480627,2197.00795792024,2193.05312366712,2189.35024204691,2185.89931305959,2182.70033670519,2179.75331298369,2177.05824189509,2174.6151234394,2172.42395761661,2170.48474442673,2168.79748386975,2167.36217594568,2166.17882065452,2165.24741799626,2164.5679679709,2164.14047057845,2163.9649258189,2164.04133369226,2164.36969419852,2164.95000733769,2165.78227310977,2166.86649151475,2168.20266255263,2169.79078622342,2171.63086252711,2173.72289146371,2176.06687303321,2178.66280723562,2181.51069407094,2184.61053353916,2187.96232564028,2191.56607037431,2195.42176774124,2199.52941774108,2203.88902037383,2208.50057563948,2213.36408353803,2218.47954406949,2223.84695723385,2229.46632303112,2235.3376414613,2241.46091252438,2247.83613622036],[2234.96493879564,2229.38019762824,2224.04151566883,2218.94889291743,2214.10232937402,2209.5018250386,2205.14737991119,2201.03899399177,2197.17666728035,2193.56039977692,2190.19019148149,2187.06604239406,2184.18795251463,2181.55592184319,2179.16995037975,2177.03003812431,2175.13618507686,2173.48839123741,2172.08665660596,2170.9309811825,2170.02136496704,2169.35780795958,2168.94031016011,2168.76887156864,2168.84349218517,2169.1641720097,2169.73091104222,2170.54370928274,2171.60256673126,2172.90748338777,2174.45845925228,2176.25549432479,2178.29858860529,2180.58774209379,2183.12295479029,2185.90422669479,2188.93155780728,2192.20494812777,2195.72439765625,2199.48990639273,2203.50147433721,2207.75910148969,2212.26278785016,2217.01253341863,2222.0083381951,2227.25020217956,2232.73812537203,2238.47210777248,2244.45214938094,2250.67825019739],[2238.34379521829,2232.88817664954,2227.67292825085,2222.69805002223,2217.96354196366,2213.46940407516,2209.21563635672,2205.20223880834,2201.42921143003,2197.89655422177,2194.60426718358,2191.55235031545,2188.74080361738,2186.16962708938,2183.83882073143,2181.74838454355,2179.89831852573,2178.28862267797,2176.91929700027,2175.79034149264,2174.90175615506,2174.25354098755,2173.8456959901,2173.67822116272,2173.75111650539,2174.06438201813,2174.61801770092,2175.41202355378,2176.44639957671,2177.72114576969,2179.23626213274,2180.99174866584,2182.98760536901,2185.22383224224,2187.70042928554,2190.41739649889,2193.37473388231,2196.57244143579,2200.01051915933,2203.68896705293,2207.6077851166,2211.76697335032,2216.16653175411,2220.80646032796,2225.68675907187,2230.80742798585,2236.16846706989,2241.76987632398,2247.61165574814,2253.69380534236],[2241.87258221879,2236.54165938428,2231.44561272597,2226.58444224389,2221.95814793801,2217.56672980836,2213.41018785492,2209.4885220777,2205.80173247669,2202.3498190519,2199.13278180332,2196.15062073096,2193.40333583482,2190.89092711489,2188.61339457118,2186.57073820368,2184.7629580124,2183.19005399734,2181.85202615849,2180.74887449586,2179.88059900944,2179.24719969924,2178.84867656525,2178.68502960748,2178.75625882593,2179.06236422059,2179.60334579147,2180.37920353856,2181.38993746187,2182.6355475614,2184.11603383714,2185.8313962891,2187.78163491727,2189.96674972166,2192.38674070226,2195.04160785908,2197.93135119212,2201.05597070137,2204.41546638684,2208.00983824852,2211.83908628642,2215.90321050054,2220.20221089087,2224.73608745742,2229.50484020018,2234.50846911916,2239.74697421435,2245.22035548577,2250.92861293339,2256.87174655723],[2245.54150324085,2240.33104934952,2235.35016386957,2230.59884680101,2226.07709814384,2221.78491789806,2217.72230606366,2213.88926264065,2210.28578762902,2206.91188102878,2203.76754283993,2200.85277306247,2198.16757169639,2195.71193874169,2193.48587419839,2191.48937806647,2189.72245034594,2188.18509103679,2186.87730013903,2185.79907765266,2184.95042357767,2184.33133791407,2183.94182066186,2183.78187182104,2183.8514913916,2184.15067937354,2184.67943576688,2185.4377605716,2186.4256537877,2187.6431154152,2189.09014545408,2190.76674390434,2192.672910766,2194.80864603904,2197.17394972346,2199.76882181928,2202.59326232647,2205.64727124506,2208.93084857503,2212.44399431639,2216.18670846914,2220.15899103327,2224.36084200879,2228.7922613957,2233.45324919399,2238.34380540367,2243.46393002473,2248.81362305718,2254.39288450102,2260.20171435625],[2249.34137686819,2244.24735402582,2239.37776973637,2234.73262399986,2230.31191681628,2226.11564818563,2222.14381810792,2218.39642658313,2214.87347361128,2211.57495919237,2208.50088332638,2205.65124601333,2203.02604725321,2200.62528704602,2198.44896539176,2196.49708229044,2194.76963774205,2193.26663174659,2191.98806430407,2190.93393541447,2190.10424507781,2189.49899329408,2189.11818006329,2188.96180538542,2189.02986926049,2189.32237168849,2189.83931266943,2190.58069220329,2191.54651029009,2192.73676692982,2194.15146212249,2195.79059586808,2197.65416816661,2199.74217901807,2202.05462842246,2204.59151637979,2207.35284289005,2210.33860795324,2213.54881156936,2216.98345373841,2220.6425344604,2224.52605373532,2228.63401156318,2232.96640794396,2237.52324287768,2242.30451636433,2247.31022840391,2252.54037899642,2257.99496814187,2263.67399584025],[2253.26359378185,2248.28214255538,2243.5201700669,2238.97767631641,2234.65466130393,2230.55112502944,2226.66706749295,2223.00248869445,2219.55738863396,2216.33176731146,2213.32562472695,2210.53896088045,2207.97177577194,2205.62406940143,2203.49584176892,2201.5870928744,2199.89782271788,2198.42803129936,2197.17771861884,2196.14688467631,2195.33552947178,2194.74365300525,2194.37125527671,2194.21833628617,2194.28489603363,2194.57093451909,2195.07645174254,2195.80144770399,2196.74592240344,2197.90987584089,2199.29330801633,2200.89621892977,2202.71860858121,2204.76047697064,2207.02182409807,2209.5026499635,2212.20295456693,2215.12273790835,2218.26199998777,2221.62074080519,2225.19896036061,2228.99665865402,2233.01383568543,2237.25049145484,2241.70662596224,2246.38223920764,2251.27733119104,2256.39190191244,2261.72595137183,2267.27947956922],[2257.30007710947,2252.42750677564,2247.76961797517,2243.32641070806,2239.09788497431,2235.08404077393,2231.28487810691,2227.70039697326,2224.33059737297,2221.17547930604,2218.23504277247,2215.50928777226,2212.99821430542,2210.70182237194,2208.62011197183,2206.75308310508,2205.10073577169,2203.66306997166,2202.44008570499,2201.43178297169,2200.63816177175,2200.05922210518,2199.69496397197,2199.54538737212,2199.61049230563,2199.8902787725,2200.38474677274,2201.09389630634,2202.01772737331,2203.15623997364,2204.50943410733,2206.07730977438,2207.85986697479,2209.85710570857,2212.06902597571,2214.49562777622,2217.13691111008,2219.99287597731,2223.06352237791,2226.34885031186,2229.84885977918,2233.56355077986,2237.49292331391,2241.63697738131,2245.99571298208,2250.56913011622,2255.35722878371,2260.36000898457,2265.57747071879,2271.00961398638],[2261.44324586798,2256.67602529443,2252.11884462847,2247.7717038701,2243.6346030193,2239.70754207609,2235.99052104045,2232.48353991241,2229.18659869194,2226.09969737906,2223.22283597376,2220.55601447604,2218.0992328859,2215.85249120335,2213.81578942837,2211.98912756099,2210.37250560118,2208.96592354896,2207.76938140431,2206.78287916725,2206.00641683778,2205.43999441588,2205.08361190157,2204.93726929484,2205.00096659569,2205.27470380413,2205.75848092015,2206.45229794375,2207.35615487493,2208.4700517137,2209.79398846004,2211.32796511397,2213.07198167549,2215.02603814458,2217.19013452126,2219.56427080552,2222.14844699736,2224.94266309679,2227.94691910379,2231.16121501838,2234.58555084055,2238.21992657031,2242.06434220765,2246.11879775256,2250.38329320507,2254.85782856515,2259.54240383282,2264.43701900807,2269.5416740909,2274.85636908131],[2265.68598123002,2261.02073034153,2256.56102665825,2252.30687018017,2248.25826090729,2244.41519883962,2240.77768397714,2237.34571631986,2234.11929586778,2231.0984226209,2228.28309657922,2225.67331774275,2223.26908611147,2221.07040168539,2219.07726446452,2217.28967444884,2215.70763163837,2214.33113603309,2213.16018763302,2212.19478643814,2211.43493244847,2210.88062566399,2210.53186608472,2210.38865371065,2210.45098854177,2210.7188705781,2211.19229981963,2211.87127626636,2212.75579991829,2213.84587077542,2215.14148883774,2216.64265410527,2218.349366578,2220.26162625593,2222.37943313906,2224.7027872274,2227.23168852093,2229.96613701966,2232.90613272359,2236.05167563272,2239.40276574706,2242.95940306659,2246.72158759132,2250.68931932126,2254.86259825639,2259.24142439673,2263.82579774226,2268.615718293,2273.61118604893,2278.81220101007],[2270.02159537036,2265.45507715686,2261.08975606624,2256.9256320985,2252.96270525365,2249.20097553168,2245.64044293258,2242.28110745637,2239.12296910304,2236.16602787259,2233.41028376503,2230.85573678034,2228.50238691853,2226.35023417961,2224.39927856357,2222.6495200704,2221.10095870012,2219.75359445272,2218.6074273282,2217.66245732657,2216.91868444781,2216.37610869193,2216.03473005894,2215.89454854883,2215.9555641616,2216.21777689724,2216.68118675578,2217.34579373719,2218.21159784148,2219.27859906865,2220.54679741871,2222.01619289164,2223.68678548746,2225.55857520616,2227.63156204774,2229.9057460122,2232.38112709954,2235.05770530977,2237.93548064287,2241.01445309886,2244.29462267772,2247.77598937947,2251.4585532041,2255.34231415161,2259.427272222,2263.71342741527,2268.20077973142,2272.88932917046,2277.77907573237,2282.87001941717],[2274.443802672,2269.97291569865,2265.69901241259,2261.62209281382,2257.74215690234,2254.05920467814,2250.57323614124,2247.28425129162,2244.19225012929,2241.29723265425,2238.59919886649,2236.09814876603,2233.79408235285,2231.68699962697,2229.77690058837,2228.06378523706,2226.54765357303,2225.2285055963,2224.10634130685,2223.1811607047,2222.45296378983,2221.92175056225,2221.58752102196,2221.45027516895,2221.51001300324,2221.76673452481,2222.22043973367,2222.87112862982,2223.71880121326,2224.76345748399,2226.005097442,2227.4437210873,2229.0793284199,2230.91191943978,2232.94149414694,2235.1680525414,2237.59159462315,2240.21212039218,2243.0296298485,2246.04412299211,2249.25559982301,2252.6640603412,2256.26950454668,2260.07193243944,2264.07134401949,2268.26773928683,2272.66111824146,2277.25148088338,2282.03882721259,2287.02315722908],[2278.94669309235,2274.56846447533,2270.38313709288,2266.39071094499,2262.59118603167,2258.98456235292,2255.57083990874,2252.35001869913,2249.32209872408,2246.4870799836,2243.84496247769,2241.39574620635,2239.13943116958,2237.07601736737,2235.20550479973,2233.52789346666,2232.04318336816,2230.75137450422,2229.65246687486,2228.74646048006,2228.03335531983,2227.51315139416,2227.18584870307,2227.05144724654,2227.10994702458,2227.36134803719,2227.80565028436,2228.44285376611,2229.27295848242,2230.2959644333,2231.51187161875,2232.92068003876,2234.52238969335,2236.3170005825,2238.30451270622,2240.4849260645,2242.85824065736,2245.42445648478,2248.18357354677,2251.13559184333,2254.28051137446,2257.61833214015,2261.14905414042,2264.87267737525,2268.78920184464,2272.89862754861,2277.20095448714,2281.69618266025,2286.38431206792,2291.26534271015],[2283.52470750854,2279.23628632303,2275.13680952883,2271.22627712592,2267.50468911433,2263.97204549403,2260.62834626504,2257.47359142735,2254.50778098097,2251.73091492589,2249.14299326211,2246.74401598964,2244.53398310847,2242.51289461861,2240.68075052005,2239.03755081279,2237.58329549684,2236.31798457219,2235.24161803884,2234.3541958968,2233.65571814606,2233.14618478663,2232.8255958185,2232.69395124167,2232.75125105615,2232.99749526193,2233.43268385902,2234.0568168474,2234.8698942271,2235.87191599809,2237.06288216039,2238.442792714,2240.01164765891,2241.76944699512,2243.71619072264,2245.85187884145,2248.17651135158,2250.69008825301,2253.39260954574,2256.28407522977,2259.36448530511,2262.63383977175,2266.0921386297,2269.73938187895,2273.5755695195,2277.60070155136,2281.81477797452,2286.21779878899,2290.80976399476,2295.59067359183],[2288.17261487778,2283.97126596748,2279.95502511402,2276.12389231738,2272.47786757757,2269.01695089459,2265.74114226843,2262.65044169911,2259.74484918661,2257.02436473094,2254.4889883321,2252.13871999009,2249.9735597049,2247.99350747655,2246.19856330502,2244.58872719032,2243.16399913244,2241.9243791314,2240.86986718719,2240.0004632998,2239.31616746924,2238.81697969551,2238.5028999786,2238.37392831853,2238.43006471528,2238.67130916886,2239.09766167927,2239.70912224651,2240.50569087058,2241.48736755147,2242.65415228919,2244.00604508375,2245.54304593512,2247.26515484333,2249.17237180837,2251.26469683023,2253.54212990892,2256.00467104444,2258.65232023679,2261.48507748596,2264.50294279197,2267.7059161548,2271.09399757446,2274.66718705095,2278.42548458427,2282.36889017441,2286.49740382138,2290.81102552519,2295.30975528582,2299.99359310327]],"type":"surface","frame":null},{"x":[5.566337279,5.567337279,5.565337279,5.566337279,5.566337279,5.130644384,5.131644384,5.129644384,5.130644384,5.130644384,4.775610078,4.776610078,4.774610078,4.775610078,4.775610078,4.942314935,4.943314935,4.941314935,4.942314935,4.942314935,4.93839175,4.93939175,4.93739175,4.93839175,4.93839175,4.947998014,4.948998014,4.946998014,4.947998014,4.947998014,4.946712764,4.947712764,4.945712764,4.946712764,4.946712764,4.94680935,4.94780935,4.94580935,4.94680935,4.94680935,4.94680935,4.94680935,5.441490286,4.452128415,5.194149818,4.699468883,5.070479584,4.823139117,5.008644467,4.884974234,4.94680935,4.94680935,4.94680935,4.94680935,4.94680935,4.94680935,4.94680935,4.94680935,5.441490286,4.452128415,5.194149818,4.699468883,5.070479584,4.823139117,5.008644467,4.884974234,4.94680935,4.947304031,4.94631467,4.94680935,4.94680935,4.947056691,4.94656201,4.94680935,4.94680935,4.946933021,4.94668568,4.94680935,4.94680935,4.946871186,4.946747515,4.94680935,4.94680935],"y":[2.503063598,2.503063598,2.503063598,2.504063598,2.502063598,1.851596952,1.851596952,1.851596952,1.852596952,1.850596952,2.096899332,2.096899332,2.096899332,2.097899332,2.095899332,2.030876402,2.030876402,2.030876402,2.031876402,2.029876402,1.969864138,1.969864138,1.969864138,1.970864138,1.968864138,1.994745289,1.994745289,1.994745289,1.995745289,1.993745289,1.993733708,1.993733708,1.993733708,1.994733708,1.992733708,1.993675863,1.993675863,1.993675863,1.994675863,1.992675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,1.993675863,2.193043449,1.794308276,2.093359656,1.893992069,2.043517759,1.943833966,2.018596811,1.968754914,2.193043449,1.794308276,2.093359656,1.893992069,2.043517759,1.943833966,2.018596811,1.968754914,1.993675863,1.993675863,1.993675863,1.99387523,1.993476495,1.993675863,1.993675863,1.993775546,1.993576179,1.993675863,1.993675863,1.993725704,1.993626021,1.993675863,1.993675863,1.993700783,1.993650942],"z":[2184.286611,2184.385574,2184.187808,2184.408283,2184.165113,2119.594262,2119.64803,2119.540785,2119.503239,2119.686016,2114.716831,2114.67801,2114.755879,2114.759644,2114.674411,2109.259656,2109.258688,2109.260866,2109.277755,2109.242015,2109.074323,2109.072283,2109.07662,2109.062232,2109.086948,2108.920105,2108.92053,2108.919931,2108.920892,2108.91982,2108.919642,2108.919744,2108.919791,2108.919921,2108.919866,2108.91964,2108.919767,2108.919765,2108.91989,2108.919893,2108.91964,2108.91964,2139.703129,2139.702195,2116.615629,2116.615162,2110.843696,2110.843462,2109.400683,2109.400566,2117.452786,2120.843311,2111.22445,2111.643075,2109.519402,2109.571641,2109.072664,2109.079227,2142.893686,2158.846465,2118.204939,2120.169969,2111.350746,2111.595386,2109.541903,2109.572405,2108.91964,2108.919671,2108.91967,2108.91965,2108.91965,2108.919648,2108.919648,2108.919642,2108.919643,2108.919642,2108.919642,2108.919641,2108.919641,2108.919641,2108.919641,2108.91964,2108.91964],"showscale":false,"mode":"markers","marker":{"color":{"orange":"#ff5500","complementary":["#ff5500","#00aaff"],"monochromatic":["#ff5500","#f26924","#e67a45","#d98a62"],"analogous":["#ff5500","#ffd500","#ff002b"],"split_complementary":["#ff5500","#002bff","#00ffd5"],"triadic":["#ff5500","#5500ff","#00ff55"],"tetradic":["#ff5500","#00aaff","#5500ff","#aaff00"]},"size":3,"line":{"color":"rgba(255,127,14,1)"}},"type":"scatter3d","showlegend":false,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[4.94680327041371],"y":[1.99367954739935],"z":[2108.91964008206],"showscale":false,"marker":{"color":"#00aaff","size":10,"line":{"color":"rgba(44,160,44,1)"}},"type":"scatter3d","showlegend":false,"mode":"markers","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><img src="Bayesian-Basics_files/figure-html/plotNormMLEpath-1.svg" width="500px" style="display: block; margin: auto;" /></p>
<br>
<p class style="font-size:.75em; text-align:center">
A bit of jitter was added to the points to better see what’s going on.
</p>
<p>Please note that there are many other considerations in optimization completely ignored here, but for our purposes and the audience for which this is intended, we do not want to lose sight of the forest for the trees. We now move next to a slightly more complicated regression example.</p>
</div>
</div>
<div id="linear-model" class="section level2">
<h2>Linear Model</h2>
<p>In the standard regression context, the expected value for the target variable comes from our linear predictor, i.e. the weighted combination of our explanatory variables, and we estimate the regression weights/coefficients and possibly other relevant parameters. We can expand our previous example to the standard linear model without too much change. In this case we estimate a mean for each observation, but otherwise assume the variance is constant across observations. Again, we first construct some data so that we know exactly what to expect, then write out the likelihood function with starting parameters. As we need to estimate our intercept and coefficient for the X predictor (collectively referred to as <span class="math inline">\(\beta\)</span>), we can think of our likelihood explicitly as before:</p>
<p><span class="math display">\[\ln\mathcal{L}(\beta, \sigma^2) = \sum_{i=1}^N \ln[\frac{1}{\sqrt{2\pi\sigma^2}}\exp(-\frac{(y-X\beta)^2}{2\sigma^2})]\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="appendix.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for replication</span></span>
<span id="cb54-2"><a href="appendix.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb54-3"><a href="appendix.html#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="appendix.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predictor</span></span>
<span id="cb54-5"><a href="appendix.html#cb54-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb54-6"><a href="appendix.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="appendix.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients for intercept and predictor</span></span>
<span id="cb54-8"><a href="appendix.html#cb54-8" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb54-9"><a href="appendix.html#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="appendix.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add intercept to X and create y with some noise</span></span>
<span id="cb54-11"><a href="appendix.html#cb54-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X) <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">sd =</span> <span class="fl">2.5</span>)</span>
<span id="cb54-12"><a href="appendix.html#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="appendix.html#cb54-13" aria-hidden="true" tabindex="-1"></a>regLL <span class="ot">=</span> <span class="cf">function</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">Int =</span> <span class="dv">0</span>, <span class="at">b1 =</span> <span class="dv">0</span>){</span>
<span id="cb54-14"><a href="appendix.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-15"><a href="appendix.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  coefs <span class="ot">=</span> <span class="fu">c</span>(Int, b1)</span>
<span id="cb54-16"><a href="appendix.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-17"><a href="appendix.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X) <span class="sc">%*%</span> coefs</span>
<span id="cb54-18"><a href="appendix.html#cb54-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-19"><a href="appendix.html#cb54-19" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">=</span> <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dnorm</span>(y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb54-20"><a href="appendix.html#cb54-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-21"><a href="appendix.html#cb54-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">paste</span>(sigma, Int, b1, ll))</span>
<span id="cb54-22"><a href="appendix.html#cb54-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-23"><a href="appendix.html#cb54-23" aria-hidden="true" tabindex="-1"></a>  ll</span>
<span id="cb54-24"><a href="appendix.html#cb54-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-25"><a href="appendix.html#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="appendix.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb54-27"><a href="appendix.html#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="appendix.html#cb54-28" aria-hidden="true" tabindex="-1"></a>mlopt <span class="ot">=</span>  <span class="fu">mle2</span>(regLL, <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>, <span class="at">lower =</span> <span class="fu">c</span>(<span class="at">sigma =</span> <span class="dv">0</span>)) </span>
<span id="cb54-29"><a href="appendix.html#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="appendix.html#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlopt)</span></code></pre></div>
<pre><code>Maximum likelihood estimation

Call:
mle2(minuslogl = regLL, method = &quot;L-BFGS-B&quot;, lower = c(sigma = 0))

Coefficients:
      Estimate Std. Error z value     Pr(z)    
sigma 2.447823   0.054735  44.721 &lt; 2.2e-16 ***
Int   5.039976   0.077435  65.087 &lt; 2.2e-16 ***
b1    2.139284   0.077652  27.549 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

-2 log L: 4628.273 </code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="appendix.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(profile(mlopt), absVal = FALSE)</span></span>
<span id="cb56-2"><a href="appendix.html#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="appendix.html#cb56-3" aria-hidden="true" tabindex="-1"></a>modlm <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> X)</span>
<span id="cb56-4"><a href="appendix.html#cb56-4" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(modlm)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)     5.04    0.0775      65.0 0        
2 X               2.14    0.0777      27.5 1.58e-124</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="appendix.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">logLik</span>(modlm)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 4628.273 (df=3)</code></pre>
<p>As before, our estimates and final log likelihood value are about where they should be, and reflect the <code>lm</code> output, as the OLS estimates are the maximum likelihood estimates. The visualization becomes more difficult beyond two parameters, but we can examine slices similar to the previous plot.</p>
<p><img src="Bayesian-Basics_files/figure-html/mlmisc-1.svg" width="672" style="display: block; margin: auto;" /></p>
<p>To move to generalized linear models, very little changes of the process. We will have a potentially different distribution assumed, and we are typically modeling a function of the target variable (e.g. <span class="math inline">\(\log(y)=X\beta; \mu = e^{X\beta}\)</span>).</p>
</div>
<div id="binomial-likelihood-example" class="section level2">
<h2>Binomial Likelihood Example</h2>
<p>This regards the example seen in the early part of the document with the hands-on example.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="appendix.html#cb60-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">p =</span> .<span class="dv">5</span>)</span>
<span id="cb60-2"><a href="appendix.html#cb60-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">p =</span> .<span class="dv">85</span>)</span>
<span id="cb60-3"><a href="appendix.html#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="appendix.html#cb60-4" aria-hidden="true" tabindex="-1"></a>binomLL <span class="ot">=</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb60-5"><a href="appendix.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">p =</span> theta, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb60-6"><a href="appendix.html#cb60-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-7"><a href="appendix.html#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="appendix.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(binomLL,</span>
<span id="cb60-9"><a href="appendix.html#cb60-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> x1,</span>
<span id="cb60-10"><a href="appendix.html#cb60-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="dv">0</span>,</span>
<span id="cb60-11"><a href="appendix.html#cb60-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>$minimum
[1] 0.5043001

$objective
[1] 1902.557</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="appendix.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x1)</span></code></pre></div>
<pre><code>[1] 5.043</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="appendix.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize</span>(binomLL,</span>
<span id="cb64-2"><a href="appendix.html#cb64-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> x2,</span>
<span id="cb64-3"><a href="appendix.html#cb64-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="dv">0</span>,</span>
<span id="cb64-4"><a href="appendix.html#cb64-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>$minimum
[1] 0.8568963

$objective
[1] 1438.786</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="appendix.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x2)</span></code></pre></div>
<pre><code>[1] 8.569</code></pre>
</div>
<div id="modeling-languages" class="section level2">
<h2>Modeling Languages</h2>
<p>I will talk only briefly about a couple of the modeling language options available, as you will have to make your own choice among many.</p>
<div id="bugs" class="section level3">
<h3>Bugs</h3>
<p>When I first wrote this document, BUGS <span class="citation">(<a href="#ref-bugsbook" role="doc-biblioref">Lunn et al. 2012</a>)</span> (<em>B</em>ayesian inference <em>U</em>sing <em>G</em>ibbs <em>S</em>ampling) was perhaps the most widely known and used Bayesian modeling language, and it has been around for over 30 years at this point. It is implemented via <a href="http://www.openbugs.net/">OpenBUGS</a> and freely available for download<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a>. It even has a GUI interface if such a thing is desired.</p>
</div>
<div id="jags" class="section level3">
<h3>JAGS</h3>
<p><a href="http://mcmc-jags.sourceforge.net/">JAGS</a> (<em>J</em>ust <em>A</em>nother <em>G</em>ibbs <em>S</em>ampler) is a more recent dialect of the BUGS language, and is also free to use. It offers some technical and modeling advantages to OpenBUGs, but much of the code translates directly from one to the other.</p>
</div>
<div id="nimble" class="section level3">
<h3>Nimble</h3>
<p><a href="https://r-nimble.org/">Nimble</a> allows one to implement BUGS style models within R, but also is highly extensible and provides additional options.</p>
</div>
<div id="stan" class="section level3">
<h3>Stan</h3>
<p><a href="http://mc-stan.org/">Stan</a> is a relative newcomer to Bayesian modeling languages, and as I write this it is about to have its 10 year anniversary. It uses a different estimation procedure than the BUGS language, and this makes it more flexible and perhaps better behaved for many types of models. It actually compiles Stan code to C++, and so can be very fast as well. In addition, it has interfaces for Python, Julia and more. I personally prefer it as I find it more clear in its expression, and there are many associated tools for model exploration.</p>
</div>
<div id="r" class="section level3">
<h3>R</h3>
<p>R has many modeling packages devoted to Bayesian analysis such that there is a <a href="http://cran.r-project.org/web/views/Bayesian.html">Task View</a> specific to the topic. Most of them are even specific to the implementation of a certain type of analysis<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a>. So not only can you do everything within R and take advantage of the power of those languages, you can then use Bayesian specific R packages on the results. For standard and even some complex models I would suggest using the <span class="pack">rstanarm</span> or <span class="pack">brms</span> packages as a way to stick to the usual R modeling style, unless you have a notably complicated model, at which point you can use <span class="pack">rstan</span>.</p>
</div>
<div id="general-statistical-packages" class="section level3">
<h3>General Statistical Packages</h3>
<p>The general statistical languages such as SAS, SPSS, and Stata were generally <em>very</em> late to the Bayesian game, even for implementations of Bayesian versions of commonly used models. SAS and Stata are fairly capable from what I can tell (but there is <a href="http://mc-stan.org/interfaces/stata-stan">StataStan</a>). Others still seem to be lacking as well. In general, I wouldn’t recommend these packages for Bayesian analysis, except as an interface to one of the Bayesian specific languages, assuming they have the capability and you are already familiar with the program.</p>
</div>
<div id="other-programming-languages" class="section level3">
<h3>Other Programming Languages</h3>
<p>Python has functionality via modules such as PyMC, and Stan has a Python implementation, PyStan. Julia and Matlab both have Stan ports as well. And with any programming language that you might use for statistical analysis, you could certainly do a lot of it by hand if you have the time, though you should exhaust tested implementations first.</p>
</div>
<div id="summary-2" class="section level3">
<h3>Summary</h3>
<p>In short, you have plenty of options. I would suggest starting with a Bayesian programming language or using that language within your chosen statistical environment or package. This gives you the most modeling flexibility, choice, and opportunity to learn.</p>
</div>
</div>
<div id="bugs-example" class="section level2">
<h2>BUGS Example</h2>
<p>The following provides a BUGS example<a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a> of the primary model used in this document. The applicable code for the data set up is in the <a href="models.html#example-linear-regression-model">Example: Linear Regression Model</a> section of the document. The model matrix X must be a <span class="objclass">matrix</span> class object. Next we setup a BUGS data list as we did with Stan, and create a text file that contains the model code. Note that the data list comprises simple characters which are used to look for objects of those names that are in the environment. Also, I use <span class="func">cat</span> with <span class="func">sink</span> so that I don’t have to go to a separate text editor to create the file.</p>
<p>One of the big differences between BUGS and other languages is its use of the precision parameter <span class="math inline">\(\frac{1}{\sigma^2}\)</span>, the inverse variance, usually denoted as <span class="math inline">\(\tau\)</span>. While there were some computational niceties to be had in doing so, even the authors admit this was not a good decision in retrospect. Prepare to have that issue come up from time to time when you inevitably forget. Comments and assignments are the same as R, and distributions noted with <span class="math inline">\(\sim\)</span>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="appendix.html#cb68-1" aria-hidden="true" tabindex="-1"></a>bugsdat <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&#39;y&#39;</span>, <span class="st">&#39;X&#39;</span>, <span class="st">&#39;N&#39;</span>, <span class="st">&#39;K&#39;</span>)</span>
<span id="cb68-2"><a href="appendix.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="appendix.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This will create a file, lmbugs.txt that will subsequently be called </span></span>
<span id="cb68-4"><a href="appendix.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&#39;data/lmbugs.txt&#39;</span>)</span>
<span id="cb68-5"><a href="appendix.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb68-6"><a href="appendix.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;model {</span></span>
<span id="cb68-7"><a href="appendix.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="st">  for (n in 1:N){</span></span>
<span id="cb68-8"><a href="appendix.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="st">    mu[n] &lt;- beta[1]*X[n,1] + beta[2]*X[n,2] + beta[3]*X[n,3] + beta[4]*X[n,4]</span></span>
<span id="cb68-9"><a href="appendix.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="st">    y[n] ~ dnorm(mu[n], inv.sigma.sq)</span></span>
<span id="cb68-10"><a href="appendix.html#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb68-11"><a href="appendix.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="st">  for (k in 1:K){</span></span>
<span id="cb68-12"><a href="appendix.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="st">    beta[k] ~ dnorm(0, .001) # prior for reg coefs</span></span>
<span id="cb68-13"><a href="appendix.html#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb68-14"><a href="appendix.html#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="st">  # Half-cauchy as in Gelman 2006</span></span>
<span id="cb68-15"><a href="appendix.html#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="st">  # Scale parameter is 5, so precision of z = 1/5^2 = 0.04</span></span>
<span id="cb68-16"><a href="appendix.html#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma.y &lt;- abs(z)/sqrt(chSq) # prior for sigma; cauchy = normal/sqrt(chi^2)</span></span>
<span id="cb68-17"><a href="appendix.html#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="st">  z ~ dnorm(0, .04)I(0,)</span></span>
<span id="cb68-18"><a href="appendix.html#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="st">  chSq ~ dgamma(0.5, 0.5) # chi^2 with 1 d.f.</span></span>
<span id="cb68-19"><a href="appendix.html#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="st">  inv.sigma.sq &lt;- pow(sigma.y, -2) # precision</span></span>
<span id="cb68-20"><a href="appendix.html#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="st">  # sigma.y ~ dgamma(.001, .001) # prior for sigma; a typical approach used.</span></span>
<span id="cb68-21"><a href="appendix.html#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb68-22"><a href="appendix.html#cb68-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-23"><a href="appendix.html#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb68-24"><a href="appendix.html#cb68-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="appendix.html#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="co"># explicitly provided initial values not necessary, but one can specify them  </span></span>
<span id="cb68-26"><a href="appendix.html#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co"># as follows, and you may have problems with variance parameters if you don&#39;t. </span></span>
<span id="cb68-27"><a href="appendix.html#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Note also that sigma.y is unnecesary if using the half-cauchy approach as  </span></span>
<span id="cb68-28"><a href="appendix.html#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co"># it is defined based on other values.</span></span>
<span id="cb68-29"><a href="appendix.html#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="appendix.html#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="co"># inits &lt;- list(list(beta=rep(0,4), sigma.y=runif(1,0,10)),</span></span>
<span id="cb68-31"><a href="appendix.html#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="co">#               list(beta=rep(0,4), sigma.y=runif(1,0,10)),</span></span>
<span id="cb68-32"><a href="appendix.html#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="co">#               list(beta=rep(0,4), sigma.y=runif(1,0,10)))</span></span>
<span id="cb68-33"><a href="appendix.html#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters &lt;- c(&#39;beta&#39;, &#39;sigma.y&#39;)</span></span></code></pre></div>
<p>Now we are ready to run the model. You’ll want to examine the help file for the <span class="func">bugs</span> function for more information. In addition, depending on your setup you may need to set the working directory and other options. Note that <code>n.thin</code> argument is used differently than other packages. One specifies the n posterior draws (per chain) you to keep want as n.iter-n.burnin. The thinned samples aren’t stored. Compare this to other packages where n.iter is the total before thinning and including burn-in, and n.keep is (n.iter-n.burnin)/n.thin. With the function used here, n.keep is the same, but as far as arguments your you’ll want to think of n.iter as the number of posterior draws <em>after</em> thinning. So the following all produce 1000 posterior draws in <span class="pack">R2OpenBUGS</span>:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
n.iter = 3000
</td>
<td style="text-align:left;">
n.thin = 1
</td>
<td style="text-align:left;">
n.burnin = 2000
</td>
</tr>
<tr>
<td style="text-align:left;">
n.iter = 3000
</td>
<td style="text-align:left;">
n.thin = 10
</td>
<td style="text-align:left;">
n.burnin = 2000
</td>
</tr>
<tr>
<td style="text-align:left;">
n.iter = 3000
</td>
<td style="text-align:left;">
n.thin = 100
</td>
<td style="text-align:left;">
n.burnin = 2000
</td>
</tr>
</tbody>
</table>
<p>In other packages, with those arguments you’d end up with 1000, 100, and 10 posterior draws.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="appendix.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2OpenBUGS)</span>
<span id="cb69-2"><a href="appendix.html#cb69-2" aria-hidden="true" tabindex="-1"></a>lmbugs <span class="ot">&lt;-</span> <span class="fu">bugs</span>(</span>
<span id="cb69-3"><a href="appendix.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  bugsdat,</span>
<span id="cb69-4"><a href="appendix.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">inits      =</span> <span class="cn">NULL</span>,</span>
<span id="cb69-5"><a href="appendix.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">c</span>(<span class="st">&#39;beta&#39;</span>, <span class="st">&#39;sigma.y&#39;</span>),</span>
<span id="cb69-6"><a href="appendix.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.file =</span> <span class="st">&#39;lmbugs.txt&#39;</span>,</span>
<span id="cb69-7"><a href="appendix.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.chains   =</span> <span class="dv">3</span>,</span>
<span id="cb69-8"><a href="appendix.html#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.iter     =</span> <span class="dv">3000</span>,</span>
<span id="cb69-9"><a href="appendix.html#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.thin     =</span> <span class="dv">10</span>,</span>
<span id="cb69-10"><a href="appendix.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.burnin   =</span> <span class="dv">2000</span></span>
<span id="cb69-11"><a href="appendix.html#cb69-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we are ready for the results, which will be the same as what we saw with Stan. In addition to the usual output, you get the <em>deviance information criterion</em> as a potential means for model comparison.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="appendix.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## lmbugs$summary</span></span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
50%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
Rhat
</th>
<th style="text-align:right;">
n.eff
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
4.65
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
5.14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2400
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3000
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-1.72
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
-1.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2100
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3000
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma.y
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
2.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3000
</td>
</tr>
<tr>
<td style="text-align:left;">
deviance
</td>
<td style="text-align:right;">
1063.61
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
1059.00
</td>
<td style="text-align:right;">
1063.00
</td>
<td style="text-align:right;">
1071.00
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3000
</td>
</tr>
</tbody>
</table>
<p>The usual model diagnostics are available with conversion of the results to a general MCMC object, here shown via the the <span class="pack">posterior</span> package. You can then use <span class="pack">bayesplot</span> or other visualization tools. Figures are not shown, but they are the typical traceplots and density plots.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="appendix.html#cb71-1" aria-hidden="true" tabindex="-1"></a>bugs_samples <span class="ot">=</span> posterior<span class="sc">::</span><span class="fu">as_draws</span>(lmbugs<span class="sc">$</span>sims.array)</span>
<span id="cb71-2"><a href="appendix.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="appendix.html#cb71-3" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">::</span><span class="fu">summarise_draws</span>(bugs_samples)</span>
<span id="cb71-4"><a href="appendix.html#cb71-4" aria-hidden="true" tabindex="-1"></a>posterior<span class="sc">::</span><span class="fu">rstar</span>(bugs_samples)</span>
<span id="cb71-5"><a href="appendix.html#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="appendix.html#cb71-6" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(bugs_samples)</span>
<span id="cb71-7"><a href="appendix.html#cb71-7" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens</span>(bugs_samples)</span></code></pre></div>
</div>
<div id="jags-example" class="section level2">
<h2>JAGS Example</h2>
<p>The following shows how to run the regression model presented earlier in the document via JAGS. Once you have the data set up as before, the data list is done in the same fashion as with BUGS. The code itself is mostly identical, save for the use of T instead of I for truncation. JAGS, being a BUGS dialect, also uses the precision parameter in lieu of the variance, which isn’t annoying at all.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="appendix.html#cb72-1" aria-hidden="true" tabindex="-1"></a>jagsdat <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb72-2"><a href="appendix.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;y&#39;</span> <span class="ot">=</span> y,</span>
<span id="cb72-3"><a href="appendix.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;X&#39;</span> <span class="ot">=</span> X,</span>
<span id="cb72-4"><a href="appendix.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;N&#39;</span> <span class="ot">=</span> N,</span>
<span id="cb72-5"><a href="appendix.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;K&#39;</span> <span class="ot">=</span> K</span>
<span id="cb72-6"><a href="appendix.html#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-7"><a href="appendix.html#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="appendix.html#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&#39;data/lmjags.txt&#39;</span>)</span>
<span id="cb72-9"><a href="appendix.html#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb72-10"><a href="appendix.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;model {</span></span>
<span id="cb72-11"><a href="appendix.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">  for (n in 1:N){</span></span>
<span id="cb72-12"><a href="appendix.html#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="st">    mu[n] &lt;- beta[1] * X[n, 1] + beta[2] * X[n, 2] + beta[3] * X[n, 3] + beta[4] * X[n, 4]</span></span>
<span id="cb72-13"><a href="appendix.html#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="st">    y[n] ~ dnorm(mu[n], inv.sigma.sq)</span></span>
<span id="cb72-14"><a href="appendix.html#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb72-15"><a href="appendix.html#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb72-16"><a href="appendix.html#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="st">  for (k in 1:K){</span></span>
<span id="cb72-17"><a href="appendix.html#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="st">    beta[k] ~ dnorm(0, .001)                               </span></span>
<span id="cb72-18"><a href="appendix.html#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb72-19"><a href="appendix.html#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb72-20"><a href="appendix.html#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="st">  # Half-cauchy as in Gelman 2006</span></span>
<span id="cb72-21"><a href="appendix.html#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # Scale parameter is 5, so precision of z = 1/5^2 = 0.04</span></span>
<span id="cb72-22"><a href="appendix.html#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma.y &lt;- z/sqrt(chSq)       </span></span>
<span id="cb72-23"><a href="appendix.html#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="st">  z ~ dnorm(0, .04)T(0,)</span></span>
<span id="cb72-24"><a href="appendix.html#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="st">  chSq ~ dgamma(0.5, 0.5)                                  </span></span>
<span id="cb72-25"><a href="appendix.html#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="st">  inv.sigma.sq &lt;- pow(sigma.y, -2)                         </span></span>
<span id="cb72-26"><a href="appendix.html#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb72-27"><a href="appendix.html#cb72-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-28"><a href="appendix.html#cb72-28" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb72-29"><a href="appendix.html#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="appendix.html#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="appendix.html#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="co"># explicitly provided initial values not necessary, but can specify as follows</span></span>
<span id="cb72-32"><a href="appendix.html#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="co"># inits &lt;- function() {</span></span>
<span id="cb72-33"><a href="appendix.html#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   list(beta = rep(0, 4), sigma.y = runif(1, 0, 10))</span></span>
<span id="cb72-34"><a href="appendix.html#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb72-35"><a href="appendix.html#cb72-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-36"><a href="appendix.html#cb72-36" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;beta&#39;</span>, <span class="st">&#39;sigma.y&#39;</span>)</span></code></pre></div>
<p>With everything set, we can now run the model. With JAGS, we have what might be called an initialization stage that sets the model up and runs through the warm-up period, after which we can then flexibly sample from the posterior via the <span class="func">coda.samples</span> function.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="appendix.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb73-2"><a href="appendix.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(coda)</span></span>
<span id="cb73-3"><a href="appendix.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="appendix.html#cb73-4" aria-hidden="true" tabindex="-1"></a>lmjagsmod <span class="ot">=</span> <span class="fu">jags.model</span>(</span>
<span id="cb73-5"><a href="appendix.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">file     =</span> <span class="st">&#39;data/lmjags.txt&#39;</span>,</span>
<span id="cb73-6"><a href="appendix.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data     =</span> jagsdat,</span>
<span id="cb73-7"><a href="appendix.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.chains =</span> <span class="dv">3</span>,</span>
<span id="cb73-8"><a href="appendix.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.adapt  =</span> <span class="dv">2000</span></span>
<span id="cb73-9"><a href="appendix.html#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inits = inits  # if you use them</span></span>
<span id="cb73-10"><a href="appendix.html#cb73-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-11"><a href="appendix.html#cb73-11" aria-hidden="true" tabindex="-1"></a>lmjags <span class="ot">=</span> <span class="fu">coda.samples</span>(</span>
<span id="cb73-12"><a href="appendix.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">model    =</span> lmjagsmod,</span>
<span id="cb73-13"><a href="appendix.html#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.iter   =</span> <span class="dv">10000</span>,</span>
<span id="cb73-14"><a href="appendix.html#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin     =</span> <span class="dv">10</span>,</span>
<span id="cb73-15"><a href="appendix.html#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.chains =</span> <span class="dv">3</span>,</span>
<span id="cb73-16"><a href="appendix.html#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable.names =</span> parameters</span>
<span id="cb73-17"><a href="appendix.html#cb73-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we have a model identical to the others, and can summarize the posterior distribution in similar fashion. As before, you can use the <span class="pack">posterior</span> and other packages as well.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="appendix.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmjags)</span>
<span id="cb74-2"><a href="appendix.html#cb74-2" aria-hidden="true" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">effectiveSize</span>(lmjags)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
<th style="text-align:left;">
ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.89
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
4.64
</td>
<td style="text-align:right;">
5.15
</td>
<td style="text-align:left;">
3000.00
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:left;">
3453.26
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-1.71
</td>
<td style="text-align:right;">
-1.22
</td>
<td style="text-align:left;">
3000.00
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:left;">
3000.00
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma.y
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
2.22
</td>
<td style="text-align:left;">
3000.00
</td>
</tr>
</tbody>
</table>
</div>
<div id="metropolis-hastings-example" class="section level2">
<h2>Metropolis Hastings Example</h2>
<p>Next depicted is a random walk Metropolis-Hastings algorithm using the data and model from prior sections of the document. I had several texts open while cobbling together this code such as <span class="citation"><a href="#ref-gelman_bda" role="doc-biblioref">Gelman et al.</a> (<a href="#ref-gelman_bda" role="doc-biblioref">2013</a>)</span>, and some oriented towards the social sciences by <span class="citation"><a href="#ref-jeff_gill_bayesian_2008" role="doc-biblioref">Gill</a> (<a href="#ref-jeff_gill_bayesian_2008" role="doc-biblioref">2008</a>)</span>, <span class="citation"><a href="#ref-simon_jackman_bayesian_2009" role="doc-biblioref">Jackman</a> (<a href="#ref-simon_jackman_bayesian_2009" role="doc-biblioref">2009</a>)</span>, and <span class="citation"><a href="#ref-scott_lynch_2007" role="doc-biblioref">Lynch</a> (<a href="#ref-scott_lynch_2007" role="doc-biblioref">2007</a>)</span> etc. Some parts of the code reflect information and code examples found therein, and follows Lynch’s code a bit more<a href="#fn66" class="footnote-ref" id="fnref66"><sup>66</sup></a>.</p>
<p>The primary functions that we need to specify regard the posterior distribution<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a>, an update step for beta coefficients, and an update step for the variance estimate.<br><br></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="appendix.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior function</span></span>
<span id="cb75-2"><a href="appendix.html#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="appendix.html#cb75-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">=</span> <span class="cf">function</span>(x, y, b, s2) {</span>
<span id="cb75-4"><a href="appendix.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args: X is the model matrix; y the target vector; b and s2 the parameters</span></span>
<span id="cb75-5"><a href="appendix.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to be estimated</span></span>
<span id="cb75-6"><a href="appendix.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="appendix.html#cb75-7" aria-hidden="true" tabindex="-1"></a>  beta   <span class="ot">=</span> b           </span>
<span id="cb75-8"><a href="appendix.html#cb75-8" aria-hidden="true" tabindex="-1"></a>  sigma  <span class="ot">=</span> <span class="fu">sqrt</span>(s2)</span>
<span id="cb75-9"><a href="appendix.html#cb75-9" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">=</span> s2</span>
<span id="cb75-10"><a href="appendix.html#cb75-10" aria-hidden="true" tabindex="-1"></a>  mu     <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb75-11"><a href="appendix.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="appendix.html#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors are b0 ~ N(0, sd = 10), sigma2 ~ invGamma(.001, .001)</span></span>
<span id="cb75-13"><a href="appendix.html#cb75-13" aria-hidden="true" tabindex="-1"></a>  priorbvarinv <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>, <span class="dv">4</span>) </span>
<span id="cb75-14"><a href="appendix.html#cb75-14" aria-hidden="true" tabindex="-1"></a>  prioralpha <span class="ot">=</span> priorbeta <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb75-15"><a href="appendix.html#cb75-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-16"><a href="appendix.html#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(sigma) <span class="sc">|</span> sigma <span class="sc">&lt;=</span> <span class="dv">0</span>) {     <span class="co"># scale parameter must be positive</span></span>
<span id="cb75-17"><a href="appendix.html#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)</span>
<span id="cb75-18"><a href="appendix.html#cb75-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-19"><a href="appendix.html#cb75-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-20"><a href="appendix.html#cb75-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that you will not find the exact same presentation across texts and </span></span>
<span id="cb75-21"><a href="appendix.html#cb75-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># other media for the log posterior in this conjugate setting.  In the end</span></span>
<span id="cb75-22"><a href="appendix.html#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># they are conceptually still (log) prior + (log) likelihood (See commented &#39;else&#39;)</span></span>
<span id="cb75-23"><a href="appendix.html#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {                            </span>
<span id="cb75-24"><a href="appendix.html#cb75-24" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">nrow</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">crossprod</span>(y<span class="sc">-</span>mu))) <span class="sc">+</span></span>
<span id="cb75-25"><a href="appendix.html#cb75-25" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">ncol</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">t</span>(beta)<span class="sc">%*%</span>priorbvarinv<span class="sc">%*%</span>beta)) <span class="sc">+</span> </span>
<span id="cb75-26"><a href="appendix.html#cb75-26" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>(prioralpha<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">+</span> <span class="fu">log</span>(sigma2) <span class="sc">-</span> priorbeta<span class="sc">/</span>sigma2 </span>
<span id="cb75-27"><a href="appendix.html#cb75-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-28"><a href="appendix.html#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># else {</span></span>
<span id="cb75-29"><a href="appendix.html#cb75-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ll = mvtnorm::dmvnorm(</span></span>
<span id="cb75-30"><a href="appendix.html#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     y,</span></span>
<span id="cb75-31"><a href="appendix.html#cb75-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     mean = mu,</span></span>
<span id="cb75-32"><a href="appendix.html#cb75-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     sigma = diag(sigma2, length(y)),</span></span>
<span id="cb75-33"><a href="appendix.html#cb75-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     log = TRUE</span></span>
<span id="cb75-34"><a href="appendix.html#cb75-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb75-35"><a href="appendix.html#cb75-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb75-36"><a href="appendix.html#cb75-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priorb = mvtnorm::dmvnorm(</span></span>
<span id="cb75-37"><a href="appendix.html#cb75-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     beta,</span></span>
<span id="cb75-38"><a href="appendix.html#cb75-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     mean = rep(0, length(beta)),</span></span>
<span id="cb75-39"><a href="appendix.html#cb75-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     sigma = diag(100, length(beta)),</span></span>
<span id="cb75-40"><a href="appendix.html#cb75-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     log = TRUE</span></span>
<span id="cb75-41"><a href="appendix.html#cb75-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb75-42"><a href="appendix.html#cb75-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb75-43"><a href="appendix.html#cb75-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priors2 = dgamma(1 / sigma2, prioralpha, priorbeta, log = TRUE)</span></span>
<span id="cb75-44"><a href="appendix.html#cb75-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb75-45"><a href="appendix.html#cb75-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior = ll + priorb + priors2</span></span>
<span id="cb75-46"><a href="appendix.html#cb75-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior</span></span>
<span id="cb75-47"><a href="appendix.html#cb75-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb75-48"><a href="appendix.html#cb75-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-49"><a href="appendix.html#cb75-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-50"><a href="appendix.html#cb75-50" aria-hidden="true" tabindex="-1"></a><span class="co"># update step for regression coefficients</span></span>
<span id="cb75-51"><a href="appendix.html#cb75-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-52"><a href="appendix.html#cb75-52" aria-hidden="true" tabindex="-1"></a>updatereg <span class="ot">=</span> <span class="cf">function</span>(i, x, y, b, s2) {</span>
<span id="cb75-53"><a href="appendix.html#cb75-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args are the same as above but with additional i iterator argument.</span></span>
<span id="cb75-54"><a href="appendix.html#cb75-54" aria-hidden="true" tabindex="-1"></a>  b[i,] <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, <span class="at">mu =</span> b[i<span class="dv">-1</span>, ], <span class="at">Sigma =</span> bvarscale)  <span class="co"># proposal/jumping distribution</span></span>
<span id="cb75-55"><a href="appendix.html#cb75-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-56"><a href="appendix.html#cb75-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare to past- does it increase the posterior probability?</span></span>
<span id="cb75-57"><a href="appendix.html#cb75-57" aria-hidden="true" tabindex="-1"></a>  postdiff <span class="ot">=</span> </span>
<span id="cb75-58"><a href="appendix.html#cb75-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">post</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">b =</span> b[i, ],   <span class="at">s2 =</span> s2[i<span class="dv">-1</span>]) <span class="sc">-</span> </span>
<span id="cb75-59"><a href="appendix.html#cb75-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">post</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">b =</span> b[i<span class="dv">-1</span>, ], <span class="at">s2 =</span> s2[i<span class="dv">-1</span>]) </span>
<span id="cb75-60"><a href="appendix.html#cb75-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-61"><a href="appendix.html#cb75-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Acceptance phase</span></span>
<span id="cb75-62"><a href="appendix.html#cb75-62" aria-hidden="true" tabindex="-1"></a>  unidraw <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb75-63"><a href="appendix.html#cb75-63" aria-hidden="true" tabindex="-1"></a>  accept  <span class="ot">=</span> unidraw <span class="sc">&lt;</span> <span class="fu">min</span>(<span class="fu">exp</span>(postdiff), <span class="dv">1</span>)  <span class="co"># accept if so</span></span>
<span id="cb75-64"><a href="appendix.html#cb75-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-65"><a href="appendix.html#cb75-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (accept) b[i,]</span>
<span id="cb75-66"><a href="appendix.html#cb75-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> b[i<span class="dv">-1</span>,]</span>
<span id="cb75-67"><a href="appendix.html#cb75-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-68"><a href="appendix.html#cb75-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-69"><a href="appendix.html#cb75-69" aria-hidden="true" tabindex="-1"></a><span class="co"># update step for sigma2</span></span>
<span id="cb75-70"><a href="appendix.html#cb75-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-71"><a href="appendix.html#cb75-71" aria-hidden="true" tabindex="-1"></a>updates2 <span class="ot">=</span> <span class="cf">function</span>(i, x, y, b, s2) {</span>
<span id="cb75-72"><a href="appendix.html#cb75-72" aria-hidden="true" tabindex="-1"></a>  s2candidate <span class="ot">=</span>  <span class="fu">rnorm</span>(<span class="dv">1</span>, s2[i<span class="dv">-1</span>], <span class="at">sd =</span> sigmascale)</span>
<span id="cb75-73"><a href="appendix.html#cb75-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-74"><a href="appendix.html#cb75-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (s2candidate <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb75-75"><a href="appendix.html#cb75-75" aria-hidden="true" tabindex="-1"></a>    accept <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb75-76"><a href="appendix.html#cb75-76" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb75-77"><a href="appendix.html#cb75-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb75-78"><a href="appendix.html#cb75-78" aria-hidden="true" tabindex="-1"></a>    s2diff <span class="ot">=</span> </span>
<span id="cb75-79"><a href="appendix.html#cb75-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">post</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">b =</span> b[i, ], <span class="at">s2 =</span> s2candidate) <span class="sc">-</span> </span>
<span id="cb75-80"><a href="appendix.html#cb75-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">post</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">b =</span> b[i, ], <span class="at">s2 =</span> s2[i<span class="dv">-1</span>])</span>
<span id="cb75-81"><a href="appendix.html#cb75-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-82"><a href="appendix.html#cb75-82" aria-hidden="true" tabindex="-1"></a>    unidraw <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb75-83"><a href="appendix.html#cb75-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-84"><a href="appendix.html#cb75-84" aria-hidden="true" tabindex="-1"></a>    accept <span class="ot">=</span> unidraw <span class="sc">&lt;</span> <span class="fu">min</span>(<span class="fu">exp</span>(s2diff), <span class="dv">1</span>)</span>
<span id="cb75-85"><a href="appendix.html#cb75-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-86"><a href="appendix.html#cb75-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-87"><a href="appendix.html#cb75-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(accept, s2candidate, s2[i<span class="dv">-1</span>])</span>
<span id="cb75-88"><a href="appendix.html#cb75-88" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we can set things up for the MCMC chain<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a>. Aside from the typical MCMC setup and initializing the parameter matrices to hold the draws from the posterior, we also require scale parameters to use for the jumping/proposal distribution.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="appendix.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup, starting values etc. </span></span>
<span id="cb76-2"><a href="appendix.html#cb76-2" aria-hidden="true" tabindex="-1"></a>nsim   <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb76-3"><a href="appendix.html#cb76-3" aria-hidden="true" tabindex="-1"></a>burnin <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb76-4"><a href="appendix.html#cb76-4" aria-hidden="true" tabindex="-1"></a>thin   <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb76-5"><a href="appendix.html#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="appendix.html#cb76-6" aria-hidden="true" tabindex="-1"></a>b  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, nsim, <span class="fu">ncol</span>(X))        <span class="co"># initialize beta update matrix</span></span>
<span id="cb76-7"><a href="appendix.html#cb76-7" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, nsim)                    <span class="co"># initialize sigma vector</span></span>
<span id="cb76-8"><a href="appendix.html#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="appendix.html#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="appendix.html#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For the following this c term comes from BDA3 12.2 and will produce an</span></span>
<span id="cb76-11"><a href="appendix.html#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># acceptance rate of .44 in 1 dimension and declining from there to about </span></span>
<span id="cb76-12"><a href="appendix.html#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co"># .23 in high dimensions. For the sigmascale, the magic number comes from </span></span>
<span id="cb76-13"><a href="appendix.html#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># starting with a value of one and fiddling from there to get around .44.</span></span>
<span id="cb76-14"><a href="appendix.html#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="appendix.html#cb76-15" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">2.4</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">ncol</span>(b))</span>
<span id="cb76-16"><a href="appendix.html#cb76-16" aria-hidden="true" tabindex="-1"></a>bvar <span class="ot">=</span> <span class="fu">vcov</span>(<span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="fu">data.frame</span>(X[, <span class="sc">-</span><span class="dv">1</span>]))) </span>
<span id="cb76-17"><a href="appendix.html#cb76-17" aria-hidden="true" tabindex="-1"></a>bvarscale  <span class="ot">=</span> bvar <span class="sc">*</span> c<span class="sc">^</span><span class="dv">2</span>               </span>
<span id="cb76-18"><a href="appendix.html#cb76-18" aria-hidden="true" tabindex="-1"></a>sigmascale <span class="ot">=</span> .<span class="dv">9</span></span></code></pre></div>
<p>We can now run and summarize the model with tools from the <span class="pack">coda</span> package.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="appendix.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run</span></span>
<span id="cb77-2"><a href="appendix.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim) {</span>
<span id="cb77-3"><a href="appendix.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  b[i, ] <span class="ot">=</span> <span class="fu">updatereg</span>(</span>
<span id="cb77-4"><a href="appendix.html#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">i  =</span> i,</span>
<span id="cb77-5"><a href="appendix.html#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y  =</span> y,</span>
<span id="cb77-6"><a href="appendix.html#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x  =</span> X,</span>
<span id="cb77-7"><a href="appendix.html#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">b  =</span> b,</span>
<span id="cb77-8"><a href="appendix.html#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">s2 =</span> s2</span>
<span id="cb77-9"><a href="appendix.html#cb77-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-10"><a href="appendix.html#cb77-10" aria-hidden="true" tabindex="-1"></a>  s2[i] <span class="ot">=</span> <span class="fu">updates2</span>(</span>
<span id="cb77-11"><a href="appendix.html#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">i  =</span> i,</span>
<span id="cb77-12"><a href="appendix.html#cb77-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y  =</span> y,</span>
<span id="cb77-13"><a href="appendix.html#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x  =</span> X,</span>
<span id="cb77-14"><a href="appendix.html#cb77-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">b  =</span> b,</span>
<span id="cb77-15"><a href="appendix.html#cb77-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">s2 =</span> s2</span>
<span id="cb77-16"><a href="appendix.html#cb77-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-17"><a href="appendix.html#cb77-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-18"><a href="appendix.html#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="appendix.html#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate acceptance rates</span></span>
<span id="cb77-20"><a href="appendix.html#cb77-20" aria-hidden="true" tabindex="-1"></a>b_acc_rate  <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">diff</span>(b[(burnin <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>nsim,]) <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb77-21"><a href="appendix.html#cb77-21" aria-hidden="true" tabindex="-1"></a>s2_acc_rate <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">diff</span>(s2[(burnin <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>nsim]) <span class="sc">!=</span> <span class="dv">0</span>)            </span>
<span id="cb77-22"><a href="appendix.html#cb77-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-23"><a href="appendix.html#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(b_acc_rate, s2_acc_rate)</span>
<span id="cb77-24"><a href="appendix.html#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="appendix.html#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="co"># get final chain</span></span>
<span id="cb77-26"><a href="appendix.html#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb77-27"><a href="appendix.html#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="appendix.html#cb77-28" aria-hidden="true" tabindex="-1"></a>b_final  <span class="ot">=</span> <span class="fu">as_draws</span>(b[<span class="fu">seq</span>(burnin <span class="sc">+</span> <span class="dv">1</span>, nsim, <span class="at">by =</span> thin), ])</span>
<span id="cb77-29"><a href="appendix.html#cb77-29" aria-hidden="true" tabindex="-1"></a>s2_final <span class="ot">=</span> <span class="fu">as_draws</span>(<span class="fu">matrix</span>(s2[<span class="fu">seq</span>(burnin <span class="sc">+</span> <span class="dv">1</span>, nsim, <span class="at">by =</span> thin)]))</span>
<span id="cb77-30"><a href="appendix.html#cb77-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-31"><a href="appendix.html#cb77-31" aria-hidden="true" tabindex="-1"></a><span class="co"># get summaries; compare to lm and stan</span></span>
<span id="cb77-32"><a href="appendix.html#cb77-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise_draws</span>(b_final)</span>
<span id="cb77-33"><a href="appendix.html#cb77-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise_draws</span>(s2_final)</span>
<span id="cb77-34"><a href="appendix.html#cb77-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-35"><a href="appendix.html#cb77-35" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">coef</span>(modlm), <span class="fu">summary</span>(modlm)<span class="sc">$</span>sigma <span class="sc">^</span> <span class="dv">2</span>), <span class="dv">3</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
mcse
</th>
<th style="text-align:right;">
q2.5
</th>
<th style="text-align:right;">
q97.5
</th>
<th style="text-align:right;">
rhat
</th>
<th style="text-align:right;">
ess_bulk
</th>
<th style="text-align:left;">
ess_tail
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta.1
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
4.64
</td>
<td style="text-align:right;">
5.14
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
276.19
</td>
<td style="text-align:left;">
331.70
</td>
</tr>
<tr>
<td style="text-align:left;">
beta.2
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
228.91
</td>
<td style="text-align:left;">
207.34
</td>
</tr>
<tr>
<td style="text-align:left;">
beta.3
</td>
<td style="text-align:right;">
-1.46
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-1.70
</td>
<td style="text-align:right;">
-1.21
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
311.59
</td>
<td style="text-align:left;">
273.93
</td>
</tr>
<tr>
<td style="text-align:left;">
beta.4
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
286.56
</td>
<td style="text-align:left;">
283.76
</td>
</tr>
<tr>
<td style="text-align:left;">
s2
</td>
<td style="text-align:right;">
4.09
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
3.42
</td>
<td style="text-align:right;">
4.86
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
396.93
</td>
<td style="text-align:left;">
390.88
</td>
</tr>
</tbody>
</table>
<p>Here is the previous Stan fit for comparison.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
4.63
</td>
<td style="text-align:right;">
5.14
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-1.72
</td>
<td style="text-align:right;">
-1.22
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
1.06
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
2.22
</td>
</tr>
</tbody>
</table>
</div>
<div id="hamiltonian-monte-carlo-example" class="section level2">
<h2>Hamiltonian Monte Carlo Example</h2>
<p>The following demonstrates Hamiltonian Monte Carlo, the technique that Stan uses, and which is a different estimation approach than the Gibbs sampler in BUGS/JAGS. If you are interested in the details enough to be reading this, I highly recommend Betancourt’s <a href="https://arxiv.org/pdf/1701.02434.pdf">conceptual introduction to HMC</a>. This example still assumes the data we used in this document, and is largely based on the code in the appendix of <span class="citation"><a href="#ref-gelman_bda" role="doc-biblioref">Gelman et al.</a> (<a href="#ref-gelman_bda" role="doc-biblioref">2013</a>)</span>.</p>
<p>First we start with the functions.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="appendix.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log posterior function</span></span>
<span id="cb78-2"><a href="appendix.html#cb78-2" aria-hidden="true" tabindex="-1"></a>log_p_th <span class="ot">=</span> <span class="cf">function</span>(X, y, theta) {</span>
<span id="cb78-3"><a href="appendix.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args: X is the model matrix; y the target vector; theta are the current </span></span>
<span id="cb78-4"><a href="appendix.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parameter estimates.</span></span>
<span id="cb78-5"><a href="appendix.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  beta   <span class="ot">=</span> theta[<span class="sc">-</span><span class="fu">length</span>(theta)]           <span class="co"># reg coefs to be estimated</span></span>
<span id="cb78-6"><a href="appendix.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  sigma  <span class="ot">=</span> theta[<span class="fu">length</span>(theta)]            <span class="co"># sigma to be estimated</span></span>
<span id="cb78-7"><a href="appendix.html#cb78-7" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb78-8"><a href="appendix.html#cb78-8" aria-hidden="true" tabindex="-1"></a>  mu     <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb78-9"><a href="appendix.html#cb78-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-10"><a href="appendix.html#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors are b0 ~ N(0, sd=10), sigma2 ~ invGamma(.001, .001)</span></span>
<span id="cb78-11"><a href="appendix.html#cb78-11" aria-hidden="true" tabindex="-1"></a>  priorbvarinv <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>, <span class="dv">4</span>) </span>
<span id="cb78-12"><a href="appendix.html#cb78-12" aria-hidden="true" tabindex="-1"></a>  prioralpha <span class="ot">=</span> priorbeta <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb78-13"><a href="appendix.html#cb78-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-14"><a href="appendix.html#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(sigma) <span class="sc">|</span> sigma<span class="sc">&lt;=</span><span class="dv">0</span>) {     <span class="co"># scale parameter must be positive, so posterior</span></span>
<span id="cb78-15"><a href="appendix.html#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)                      <span class="co"># density is zero if it jumps below zero</span></span>
<span id="cb78-16"><a href="appendix.html#cb78-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-17"><a href="appendix.html#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># log posterior in this conjugate setting. conceptually it&#39;s </span></span>
<span id="cb78-18"><a href="appendix.html#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (log) prior + (log) likelihood. (See commented &#39;else&#39;)</span></span>
<span id="cb78-19"><a href="appendix.html#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb78-20"><a href="appendix.html#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">nrow</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">crossprod</span>(y<span class="sc">-</span>mu))) <span class="sc">+</span></span>
<span id="cb78-21"><a href="appendix.html#cb78-21" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">ncol</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">t</span>(beta)<span class="sc">%*%</span>priorbvarinv<span class="sc">%*%</span>beta)) <span class="sc">+</span></span>
<span id="cb78-22"><a href="appendix.html#cb78-22" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>(prioralpha<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">+</span> <span class="fu">log</span>(sigma2) <span class="sc">-</span> priorbeta<span class="sc">/</span>sigma2</span>
<span id="cb78-23"><a href="appendix.html#cb78-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-24"><a href="appendix.html#cb78-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># else {</span></span>
<span id="cb78-25"><a href="appendix.html#cb78-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ll = mvtnorm::dmvnorm(</span></span>
<span id="cb78-26"><a href="appendix.html#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     y,</span></span>
<span id="cb78-27"><a href="appendix.html#cb78-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     mean  = mu,</span></span>
<span id="cb78-28"><a href="appendix.html#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     sigma = diag(sigma2, length(y)),</span></span>
<span id="cb78-29"><a href="appendix.html#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     log   = TRUE</span></span>
<span id="cb78-30"><a href="appendix.html#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb78-31"><a href="appendix.html#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priorb = mvtnorm::dmvnorm(</span></span>
<span id="cb78-32"><a href="appendix.html#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     beta,</span></span>
<span id="cb78-33"><a href="appendix.html#cb78-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     mean  = rep(0, length(beta)),</span></span>
<span id="cb78-34"><a href="appendix.html#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     sigma = diag(100, length(beta)),</span></span>
<span id="cb78-35"><a href="appendix.html#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     log   = TRUE</span></span>
<span id="cb78-36"><a href="appendix.html#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb78-37"><a href="appendix.html#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priors2 = dgamma(1/sigma2, prioralpha, priorbeta, log = TRUE)</span></span>
<span id="cb78-38"><a href="appendix.html#cb78-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior = ll + priorb + priors2</span></span>
<span id="cb78-39"><a href="appendix.html#cb78-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior</span></span>
<span id="cb78-40"><a href="appendix.html#cb78-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb78-41"><a href="appendix.html#cb78-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-42"><a href="appendix.html#cb78-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-43"><a href="appendix.html#cb78-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-44"><a href="appendix.html#cb78-44" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical gradient function as given in BDA3 p. 602; same args as posterior</span></span>
<span id="cb78-45"><a href="appendix.html#cb78-45" aria-hidden="true" tabindex="-1"></a>gradient_theta_numerical <span class="ot">=</span> <span class="cf">function</span>(X, y, theta) {</span>
<span id="cb78-46"><a href="appendix.html#cb78-46" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">length</span>(theta)</span>
<span id="cb78-47"><a href="appendix.html#cb78-47" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">=</span> .<span class="dv">0001</span></span>
<span id="cb78-48"><a href="appendix.html#cb78-48" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb78-49"><a href="appendix.html#cb78-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-50"><a href="appendix.html#cb78-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb78-51"><a href="appendix.html#cb78-51" aria-hidden="true" tabindex="-1"></a>    th_hi <span class="ot">=</span> theta</span>
<span id="cb78-52"><a href="appendix.html#cb78-52" aria-hidden="true" tabindex="-1"></a>    th_lo <span class="ot">=</span> theta</span>
<span id="cb78-53"><a href="appendix.html#cb78-53" aria-hidden="true" tabindex="-1"></a>    th_hi[k] <span class="ot">=</span> theta[k] <span class="sc">+</span> e</span>
<span id="cb78-54"><a href="appendix.html#cb78-54" aria-hidden="true" tabindex="-1"></a>    th_lo[k] <span class="ot">=</span> theta[k] <span class="sc">-</span> e</span>
<span id="cb78-55"><a href="appendix.html#cb78-55" aria-hidden="true" tabindex="-1"></a>    diffs[k] <span class="ot">=</span> (<span class="fu">log_p_th</span>(X, y, th_hi) <span class="sc">-</span> <span class="fu">log_p_th</span>(X, y, th_lo)) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>e)</span>
<span id="cb78-56"><a href="appendix.html#cb78-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-57"><a href="appendix.html#cb78-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-58"><a href="appendix.html#cb78-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(diffs)</span>
<span id="cb78-59"><a href="appendix.html#cb78-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-60"><a href="appendix.html#cb78-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-61"><a href="appendix.html#cb78-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-62"><a href="appendix.html#cb78-62" aria-hidden="true" tabindex="-1"></a><span class="co"># single HMC iteration function</span></span>
<span id="cb78-63"><a href="appendix.html#cb78-63" aria-hidden="true" tabindex="-1"></a>hmc_iteration <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb78-64"><a href="appendix.html#cb78-64" aria-hidden="true" tabindex="-1"></a>  X, </span>
<span id="cb78-65"><a href="appendix.html#cb78-65" aria-hidden="true" tabindex="-1"></a>  y, </span>
<span id="cb78-66"><a href="appendix.html#cb78-66" aria-hidden="true" tabindex="-1"></a>  theta, </span>
<span id="cb78-67"><a href="appendix.html#cb78-67" aria-hidden="true" tabindex="-1"></a>  epsilon, </span>
<span id="cb78-68"><a href="appendix.html#cb78-68" aria-hidden="true" tabindex="-1"></a>  L, </span>
<span id="cb78-69"><a href="appendix.html#cb78-69" aria-hidden="true" tabindex="-1"></a>  M</span>
<span id="cb78-70"><a href="appendix.html#cb78-70" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb78-71"><a href="appendix.html#cb78-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args: epsilon is the stepsize; L is the number of leapfrog steps; epsilon</span></span>
<span id="cb78-72"><a href="appendix.html#cb78-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and L are drawn randomly at each iteration to explore other areas of the</span></span>
<span id="cb78-73"><a href="appendix.html#cb78-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior (starting with epsilon0 and L0); M is a diagonal mass matrix </span></span>
<span id="cb78-74"><a href="appendix.html#cb78-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (expressed as a vector), a bit of a magic number in this setting. It regards</span></span>
<span id="cb78-75"><a href="appendix.html#cb78-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the mass of a particle whose position is represented by theta, and momentum </span></span>
<span id="cb78-76"><a href="appendix.html#cb78-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># by phi. See the sampling section of chapter 1 in the Stan manual for more</span></span>
<span id="cb78-77"><a href="appendix.html#cb78-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># detail.</span></span>
<span id="cb78-78"><a href="appendix.html#cb78-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-79"><a href="appendix.html#cb78-79" aria-hidden="true" tabindex="-1"></a>  M_inv     <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>M</span>
<span id="cb78-80"><a href="appendix.html#cb78-80" aria-hidden="true" tabindex="-1"></a>  d         <span class="ot">=</span> <span class="fu">length</span>(theta)</span>
<span id="cb78-81"><a href="appendix.html#cb78-81" aria-hidden="true" tabindex="-1"></a>  phi       <span class="ot">=</span> <span class="fu">rnorm</span>(d, <span class="dv">0</span>, <span class="fu">sqrt</span>(M))</span>
<span id="cb78-82"><a href="appendix.html#cb78-82" aria-hidden="true" tabindex="-1"></a>  th_old    <span class="ot">=</span> theta</span>
<span id="cb78-83"><a href="appendix.html#cb78-83" aria-hidden="true" tabindex="-1"></a>  log_p_old <span class="ot">=</span> <span class="fu">log_p_th</span>(X, y, theta) <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span><span class="fu">sum</span>(M_inv<span class="sc">*</span>phi<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb78-84"><a href="appendix.html#cb78-84" aria-hidden="true" tabindex="-1"></a>  phi       <span class="ot">=</span> phi <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> epsilon <span class="sc">*</span> <span class="fu">gradient_theta_numerical</span>(X, y, theta)</span>
<span id="cb78-85"><a href="appendix.html#cb78-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-86"><a href="appendix.html#cb78-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L) {</span>
<span id="cb78-87"><a href="appendix.html#cb78-87" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">=</span> theta <span class="sc">+</span> epsilon<span class="sc">*</span>M_inv<span class="sc">*</span>phi</span>
<span id="cb78-88"><a href="appendix.html#cb78-88" aria-hidden="true" tabindex="-1"></a>    phi <span class="ot">=</span> phi <span class="sc">+</span> <span class="fu">ifelse</span>(l <span class="sc">==</span> L, .<span class="dv">5</span>, <span class="dv">1</span>) <span class="sc">*</span> </span>
<span id="cb78-89"><a href="appendix.html#cb78-89" aria-hidden="true" tabindex="-1"></a>      epsilon <span class="sc">*</span> <span class="fu">gradient_theta_numerical</span>(X, y, theta)</span>
<span id="cb78-90"><a href="appendix.html#cb78-90" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-91"><a href="appendix.html#cb78-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-92"><a href="appendix.html#cb78-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we get into standard MCMC stuff, jump or not based on a draw from a</span></span>
<span id="cb78-93"><a href="appendix.html#cb78-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># proposal distribution</span></span>
<span id="cb78-94"><a href="appendix.html#cb78-94" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="sc">-</span>phi</span>
<span id="cb78-95"><a href="appendix.html#cb78-95" aria-hidden="true" tabindex="-1"></a>  log_p_star <span class="ot">=</span> <span class="fu">log_p_th</span>(X, y, theta) <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">*</span> <span class="fu">sum</span>(M_inv <span class="sc">*</span> phi<span class="sc">^</span><span class="dv">2</span>)    </span>
<span id="cb78-96"><a href="appendix.html#cb78-96" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">=</span> <span class="fu">exp</span>(log_p_star <span class="sc">-</span> log_p_old)</span>
<span id="cb78-97"><a href="appendix.html#cb78-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-98"><a href="appendix.html#cb78-98" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(r)) r <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb78-99"><a href="appendix.html#cb78-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-100"><a href="appendix.html#cb78-100" aria-hidden="true" tabindex="-1"></a>  p_jump <span class="ot">=</span> <span class="fu">min</span>(r, <span class="dv">1</span>)</span>
<span id="cb78-101"><a href="appendix.html#cb78-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-102"><a href="appendix.html#cb78-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> p_jump) {</span>
<span id="cb78-103"><a href="appendix.html#cb78-103" aria-hidden="true" tabindex="-1"></a>    th_new <span class="ot">=</span> theta</span>
<span id="cb78-104"><a href="appendix.html#cb78-104" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-105"><a href="appendix.html#cb78-105" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb78-106"><a href="appendix.html#cb78-106" aria-hidden="true" tabindex="-1"></a>    th_new <span class="ot">=</span> th_old</span>
<span id="cb78-107"><a href="appendix.html#cb78-107" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-108"><a href="appendix.html#cb78-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-109"><a href="appendix.html#cb78-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> th_new, <span class="at">p_jump =</span> p_jump))  <span class="co"># returns estimates and acceptance rate</span></span>
<span id="cb78-110"><a href="appendix.html#cb78-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-111"><a href="appendix.html#cb78-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-112"><a href="appendix.html#cb78-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-113"><a href="appendix.html#cb78-113" aria-hidden="true" tabindex="-1"></a><span class="co"># main HMC function</span></span>
<span id="cb78-114"><a href="appendix.html#cb78-114" aria-hidden="true" tabindex="-1"></a>hmc_run <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb78-115"><a href="appendix.html#cb78-115" aria-hidden="true" tabindex="-1"></a>  starts,    <span class="co"># starting values for theta</span></span>
<span id="cb78-116"><a href="appendix.html#cb78-116" aria-hidden="true" tabindex="-1"></a>  iter,      <span class="co"># total number of simulations for each chain; chain is based on the dimension of starts</span></span>
<span id="cb78-117"><a href="appendix.html#cb78-117" aria-hidden="true" tabindex="-1"></a>  warmup,    <span class="co"># determines initial iterations that will be ignored for inference purposes</span></span>
<span id="cb78-118"><a href="appendix.html#cb78-118" aria-hidden="true" tabindex="-1"></a>  epsilon_0, <span class="co"># the baseline stepsize</span></span>
<span id="cb78-119"><a href="appendix.html#cb78-119" aria-hidden="true" tabindex="-1"></a>  L_0,       <span class="co"># the baseline number of leapfrog steps</span></span>
<span id="cb78-120"><a href="appendix.html#cb78-120" aria-hidden="true" tabindex="-1"></a>  M,         <span class="co"># the mass vector</span></span>
<span id="cb78-121"><a href="appendix.html#cb78-121" aria-hidden="true" tabindex="-1"></a>  X,          </span>
<span id="cb78-122"><a href="appendix.html#cb78-122" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb78-123"><a href="appendix.html#cb78-123" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb78-124"><a href="appendix.html#cb78-124" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args: </span></span>
<span id="cb78-125"><a href="appendix.html#cb78-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-126"><a href="appendix.html#cb78-126" aria-hidden="true" tabindex="-1"></a>  chains <span class="ot">=</span> <span class="fu">nrow</span>(starts)</span>
<span id="cb78-127"><a href="appendix.html#cb78-127" aria-hidden="true" tabindex="-1"></a>  d      <span class="ot">=</span> <span class="fu">ncol</span>(starts)</span>
<span id="cb78-128"><a href="appendix.html#cb78-128" aria-hidden="true" tabindex="-1"></a>  sims   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(iter, chains, d), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="fu">colnames</span>(starts)))</span>
<span id="cb78-129"><a href="appendix.html#cb78-129" aria-hidden="true" tabindex="-1"></a>  p_jump <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, iter, chains)</span>
<span id="cb78-130"><a href="appendix.html#cb78-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-131"><a href="appendix.html#cb78-131" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb78-132"><a href="appendix.html#cb78-132" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">=</span> starts[j, ]</span>
<span id="cb78-133"><a href="appendix.html#cb78-133" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-134"><a href="appendix.html#cb78-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb78-135"><a href="appendix.html#cb78-135" aria-hidden="true" tabindex="-1"></a>      epsilon <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> epsilon_0)</span>
<span id="cb78-136"><a href="appendix.html#cb78-136" aria-hidden="true" tabindex="-1"></a>      L <span class="ot">=</span> <span class="fu">ceiling</span>(<span class="dv">2</span> <span class="sc">*</span> L_0 <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>))</span>
<span id="cb78-137"><a href="appendix.html#cb78-137" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb78-138"><a href="appendix.html#cb78-138" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">=</span> <span class="fu">hmc_iteration</span>(X, y, theta, epsilon, L, M)</span>
<span id="cb78-139"><a href="appendix.html#cb78-139" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb78-140"><a href="appendix.html#cb78-140" aria-hidden="true" tabindex="-1"></a>      p_jump[t, j] <span class="ot">=</span> temp<span class="sc">$</span>p_jump</span>
<span id="cb78-141"><a href="appendix.html#cb78-141" aria-hidden="true" tabindex="-1"></a>      sims[t, j,] <span class="ot">=</span> temp<span class="sc">$</span>theta</span>
<span id="cb78-142"><a href="appendix.html#cb78-142" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb78-143"><a href="appendix.html#cb78-143" aria-hidden="true" tabindex="-1"></a>      theta <span class="ot">=</span> temp<span class="sc">$</span>theta</span>
<span id="cb78-144"><a href="appendix.html#cb78-144" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-145"><a href="appendix.html#cb78-145" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-146"><a href="appendix.html#cb78-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-147"><a href="appendix.html#cb78-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rstan::monitor(sims, warmup, digits_summary=3)</span></span>
<span id="cb78-148"><a href="appendix.html#cb78-148" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(p_jump[(warmup <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter,]), <span class="dv">3</span>)  <span class="co"># acceptance rate</span></span>
<span id="cb78-149"><a href="appendix.html#cb78-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-150"><a href="appendix.html#cb78-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(</span>
<span id="cb78-151"><a href="appendix.html#cb78-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Avg acceptance probability for each chain: &#39;</span>,</span>
<span id="cb78-152"><a href="appendix.html#cb78-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(acc[<span class="dv">1</span>], <span class="st">&#39;, &#39;</span>, acc[<span class="dv">2</span>]),          <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span></span>
<span id="cb78-153"><a href="appendix.html#cb78-153" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-154"><a href="appendix.html#cb78-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-155"><a href="appendix.html#cb78-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sims =</span> sims, <span class="at">p_jump =</span> p_jump))</span>
<span id="cb78-156"><a href="appendix.html#cb78-156" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>With the primary functions in place, we set the starting values and choose other settings for for the HMC process. The coefficient starting values are based on random draws from a uniform distribution, while <span class="math inline">\(\sigma\)</span> is set to a value of one in each case. For this example we’ll have 2000 total draws with warm-up set to 1000. I don’t have any thinning option here, but that could be added or simply done as part of the <span class="pack">coda</span> package preparation.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="appendix.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting values and mcmc settings</span></span>
<span id="cb79-2"><a href="appendix.html#cb79-2" aria-hidden="true" tabindex="-1"></a>parnames <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;beta[&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&#39;]&#39;</span>), <span class="st">&#39;sigma&#39;</span>)</span>
<span id="cb79-3"><a href="appendix.html#cb79-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">length</span>(parnames)</span>
<span id="cb79-4"><a href="appendix.html#cb79-4" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb79-5"><a href="appendix.html#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="appendix.html#cb79-6" aria-hidden="true" tabindex="-1"></a>thetastart <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">replicate</span>(chains, <span class="fu">c</span>(<span class="fu">runif</span>(d<span class="dv">-1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">1</span>)))</span>
<span id="cb79-7"><a href="appendix.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(thetastart) <span class="ot">=</span> parnames</span>
<span id="cb79-8"><a href="appendix.html#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="appendix.html#cb79-9" aria-hidden="true" tabindex="-1"></a>nsim   <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb79-10"><a href="appendix.html#cb79-10" aria-hidden="true" tabindex="-1"></a>warmup <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb79-11"><a href="appendix.html#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="appendix.html#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fiddle with these to get a desirable acceptance rate of around .80. The</span></span>
<span id="cb79-13"><a href="appendix.html#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># following work well with the document data.</span></span>
<span id="cb79-14"><a href="appendix.html#cb79-14" aria-hidden="true" tabindex="-1"></a>stepsize <span class="ot">=</span> .<span class="dv">08</span></span>
<span id="cb79-15"><a href="appendix.html#cb79-15" aria-hidden="true" tabindex="-1"></a>nLeap    <span class="ot">=</span> <span class="dv">10</span></span></code></pre></div>
<p>We are now ready to run the model. On my machine and with the above settings, this took a couple seconds. Once complete, we can use the <span class="pack">posterior</span> package as we have done before.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="appendix.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the model</span></span>
<span id="cb80-2"><a href="appendix.html#cb80-2" aria-hidden="true" tabindex="-1"></a>fit_hmc <span class="ot">=</span> <span class="fu">hmc_run</span>(</span>
<span id="cb80-3"><a href="appendix.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">starts    =</span> thetastart,</span>
<span id="cb80-4"><a href="appendix.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter      =</span> nsim,</span>
<span id="cb80-5"><a href="appendix.html#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup    =</span> warmup,</span>
<span id="cb80-6"><a href="appendix.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">epsilon_0 =</span> stepsize,</span>
<span id="cb80-7"><a href="appendix.html#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">L_0       =</span> nLeap,</span>
<span id="cb80-8"><a href="appendix.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">M         =</span> mass_vector,</span>
<span id="cb80-9"><a href="appendix.html#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X         =</span> X,</span>
<span id="cb80-10"><a href="appendix.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y         =</span> y</span>
<span id="cb80-11"><a href="appendix.html#cb80-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-12"><a href="appendix.html#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="appendix.html#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># str(fit_hmc, 1)</span></span>
<span id="cb80-14"><a href="appendix.html#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="appendix.html#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co"># use posterior to summarize the two chains</span></span>
<span id="cb80-16"><a href="appendix.html#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb80-17"><a href="appendix.html#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="appendix.html#cb80-18" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">as_draws_array</span>(fit_hmc<span class="sc">$</span>sims[(warmup <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>nsim, , ])</span>
<span id="cb80-19"><a href="appendix.html#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise_draws</span>(theta)</span>
<span id="cb80-20"><a href="appendix.html#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="appendix.html#cb80-21" aria-hidden="true" tabindex="-1"></a>finalest <span class="ot">=</span>  <span class="fu">summary</span>(theta)<span class="sc">$</span>mean</span>
<span id="cb80-22"><a href="appendix.html#cb80-22" aria-hidden="true" tabindex="-1"></a>b   <span class="ot">=</span> finalest[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb80-23"><a href="appendix.html#cb80-23" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">=</span> finalest[<span class="dv">5</span>]</span>
<span id="cb80-24"><a href="appendix.html#cb80-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-25"><a href="appendix.html#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="co"># log posterior</span></span>
<span id="cb80-26"><a href="appendix.html#cb80-26" aria-hidden="true" tabindex="-1"></a><span class="fu">log_p_th</span>(X, y, finalest)</span></code></pre></div>
<pre><code>Avg acceptance probability for each chain: 0.823, 0.814</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
mcse
</th>
<th style="text-align:right;">
q2.5
</th>
<th style="text-align:right;">
q97.5
</th>
<th style="text-align:right;">
rhat
</th>
<th style="text-align:right;">
ess_bulk
</th>
<th style="text-align:left;">
ess_tail
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.66
</td>
<td style="text-align:right;">
5.13
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
1261.80
</td>
<td style="text-align:left;">
892.17
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1204.27
</td>
<td style="text-align:left;">
792.15
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1.71
</td>
<td style="text-align:right;">
-1.23
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1308.67
</td>
<td style="text-align:left;">
1039.06
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.07
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:right;">
1247.88
</td>
<td style="text-align:left;">
826.81
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
2.01
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.85
</td>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1389.68
</td>
<td style="text-align:left;">
1051.83
</td>
</tr>
</tbody>
</table>
<pre><code>log posterior = -301.716</code></pre>
<p>Our estimates look pretty good, and inspection of the diagnostics would show good mixing and convergence as well. At this point we can compare it to the Stan output. For the following, I modified the previous Stan code to use the same inverse gamma prior and tweaked the control options for a little bit more similarity.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.90
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
4.64
</td>
<td style="text-align:right;">
5.14
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.34
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
-1.72
</td>
<td style="text-align:right;">
-1.22
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
1.06
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
2.22
</td>
</tr>
</tbody>
</table>
<pre><code>log posterior = -301.532</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gelman_bda" class="csl-entry">
Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, and Donald B. Rubin. 2013. <em>Bayesian Data Analysis</em>. 3rd ed. <a href="http://www.stat.columbia.edu/~gelman/book/">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-jeff_gill_bayesian_2008" class="csl-entry">
Gill, Jeff. 2008. <em>Bayesian Methods : A Social and Behavioral Sciences Approach</em>. Second. Boca Raton: Chapman &amp; <span>Hall/CRC</span>.
</div>
<div id="ref-simon_jackman_bayesian_2009" class="csl-entry">
Jackman, Simon. 2009. <em>Bayesian Analysis for the Social Sciences</em>. Chichester, <span>UK</span>: Wiley.
</div>
<div id="ref-bugsbook" class="csl-entry">
Lunn, David, Chris Jackson, Nicky Best, Andrew Thomas, and David Spiegelhalter. 2012. <em>The <span>BUGS</span> Book: A Practical Introduction to Bayesian Analysis</em>. Boca Raton, <span>FL</span>: Chapman; <span>Hall/CRC</span>.
</div>
<div id="ref-scott_lynch_2007" class="csl-entry">
Lynch, Scott M. 2007. <em>Introduction to Applied Bayesian Statistics and Estimation for Social Scientists</em>. New York: Springer.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="56">
<li id="fn56"><p>Math refresher on logs: <code>log(A*B) = log(A)+log(B)</code>. So summing the log probabilities will result in the same values for <span class="math inline">\(\theta\)</span>, but won’t result in extremely small values that will break our computer.<a href="appendix.html#fnref56" class="footnote-back">↩︎</a></p></li>
<li id="fn57"><p>Of course, we could just use the sample estimates, but this is for demonstration.<a href="appendix.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p>Type <code>?Distributions</code> at the console for some of the basic R distributions available.<a href="appendix.html#fnref58" class="footnote-back">↩︎</a></p></li>
<li id="fn59"><p>Much more straightforward than writing the likelihood function as above.<a href="appendix.html#fnref59" class="footnote-back">↩︎</a></p></li>
<li id="fn60"><p>An alternative approach would be to work with the log of <span class="math inline">\(\sigma\)</span> which can take on negative values, and then convert it back to the original scale.<a href="appendix.html#fnref60" class="footnote-back">↩︎</a></p></li>
<li id="fn61"><p>Actually, there is a difference between the sigma estimates in that OLS estimates are based on a variance estimate divided by <span class="math inline">\(N-p\)</span> while the MLE estimate has a divisor of <span class="math inline">\(N\)</span>.<a href="appendix.html#fnref61" class="footnote-back">↩︎</a></p></li>
<li id="fn62"><p>Which is equivalent to finding the point where the slope of the tangent line for some function to the surface is zero. The derivative, or gradient in the case of multiple parameters, of the likelihood function with respect to the parameters is known as the <em>score function</em>.<a href="appendix.html#fnref62" class="footnote-back">↩︎</a></p></li>
<li id="fn63"><p>You might come across a previous incarnation, WinBugs, but it is no longer being developed.<a href="appendix.html#fnref63" class="footnote-back">↩︎</a></p></li>
<li id="fn64"><p>Many of these packages, if not all of them, will be less flexible in model specification compared to implementing the model in the aforementioned languages directly, or using the R interface to those languages. What’s more, R has interfaces to the previous language engines via the packages <span class="pack">nimble</span>, <span class="pack">rjags</span>, and <span class="pack">rstan</span>, <span class="pack">rstanarm</span>, <span class="pack">
brms</span>, and many others.<a href="appendix.html#fnref64" class="footnote-back">↩︎</a></p></li>
<li id="fn65"><p>A word of warning, I haven’t even had R2OpenBUGS on my machine in years, so this code for post-processing the model may be a bit iffy depending on how the package works these days. The model code, which is the important part, is fine though. The JAGS section has been recently tested however.<a href="appendix.html#fnref65" class="footnote-back">↩︎</a></p></li>
<li id="fn66"><p>Some of these texts may have more recent editions, so consult those if interested.<a href="appendix.html#fnref66" class="footnote-back">↩︎</a></p></li>
<li id="fn67"><p>Assuming normal for <span class="math inline">\(\beta\)</span> coefficients, inverse gamma on <span class="math inline">\(\sigma^2\)</span>.<a href="appendix.html#fnref67" class="footnote-back">↩︎</a></p></li>
<li id="fn68"><p>This code regards only one chain, though a simple loop or any number of other approaches would easily extend it to two or more.<a href="appendix.html#fnref68" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="conclusion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["twitter", "facebook", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Bayesian-Basics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
